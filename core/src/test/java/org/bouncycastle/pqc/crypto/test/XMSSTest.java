package org.bouncycastle.pqc.crypto.test;

import java.text.ParseException;
import java.util.Arrays;

import org.bouncycastle.crypto.digests.SHA256Digest;
import org.bouncycastle.crypto.digests.SHA512Digest;
import org.bouncycastle.pqc.crypto.xmss.NullPRNG;
import org.bouncycastle.pqc.crypto.xmss.XMSS;
import org.bouncycastle.pqc.crypto.xmss.XMSSParameters;
import org.bouncycastle.pqc.crypto.xmss.XMSSUtil;
import org.bouncycastle.util.encoders.Hex;

import junit.framework.TestCase;

/**
 * Test cases for XMSS class.
 * 
 * @author Sebastian Roland <seroland86@gmail.com>
 */
public class XMSSTest extends TestCase {

	public void testGenKeyPairSHA256() {
		XMSSParameters xmssParams = new XMSSParameters(10, new SHA256Digest(), 16);
		XMSS xmss = new XMSS(xmssParams, new NullPRNG());
		xmss.generateKeys();
		byte[] privateKey = xmss.getPrivateKey();
		byte[] publicKey = xmss.getPublicKey();
		String expectedPrivateKey = "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000085572e93d9ac8912ba698b74fa4801a14f30a412f4a5e44b0a465acb05fe250";
		String expectedPublicKey = "01000001085572e93d9ac8912ba698b74fa4801a14f30a412f4a5e44b0a465acb05fe2500000000000000000000000000000000000000000000000000000000000000000";
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedPrivateKey), privateKey));
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedPublicKey), publicKey));
	}
	
	public void testGenKeyPairSHA512() {
		XMSSParameters xmssParams = new XMSSParameters(10, new SHA512Digest(), 16);
		XMSS xmss = new XMSS(xmssParams, new NullPRNG());
		xmss.generateKeys();
		byte[] privateKey = xmss.getPrivateKey();
		byte[] publicKey = xmss.getPublicKey();
		String expectedPrivateKey = "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c069f08f0a61ab2647cd4c4395be53e9f09532131db6387662ab646ca4ee39da1ecaf3506aae5554eaaf9c195482b8c232ea8d47bffb1115b08b3533f22d68e0";
		String expectedPublicKey = "04000004c069f08f0a61ab2647cd4c4395be53e9f09532131db6387662ab646ca4ee39da1ecaf3506aae5554eaaf9c195482b8c232ea8d47bffb1115b08b3533f22d68e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedPrivateKey), privateKey));
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedPublicKey), publicKey));
	}
	
	public void testSignSHA256() {
		XMSSParameters params = new XMSSParameters(10, new SHA256Digest(), 16);
		XMSS xmss = new XMSS(params, new NullPRNG());
		xmss.generateKeys();
		byte[] message = new byte[1024];
		byte[] sig1 = xmss.sign(message);
		byte[] sig2 = xmss.sign(message);
		byte[] sig3 = xmss.sign(message);
		String expectedSig1 = "000000006945a6f13aa83e598cb8d0abebb5cddbd87e576226517f9001c1d36bb320bf8063b870bc1dfd1813d98dda759fa8e874d4b39a355c92e9bf4381fd94732678c728f26560243926420d87b78f3d7388af1e85204c7cb389a9d33db5e913d3a4e21837381b72f801f889b784bc13d0b92572f7fa9cce61441d36b25d20344f9f6e8833d2a9646b2d2a99ecb2bec4b3c536771e53ce30271c0097a2c3e0e934ce401c3a5ff2f23dafa2d526bab354fb8dd3ecad23e7e0d8cc7724a6fc5d81c0293f852a7b4061f06635c566a219b6bd2f375e073c49effed885982120e16e5efaa7512c77c392b368f817e13fc10050b181aa5ef9294e6d90f1ade14f0774e7059358cc26892e67cff59d1dc5e69f61cdce5881a415be5e77846933b46b5d306527a31ce1286d5efe6afb2cb2a1023fb49837fcdcfb4eee0ea3ab6759afde296ee3e523da1cfd009cbad305e47f25cf8b542b5e96ded15702975f21afe3afc41393fbe698471f69f63082c4a1942de3af59070f960e5bb3bbe81ebe4bb75d478a6597c875db365b518663e206bd00f98879adae2b3ca16f6cc93f8a0e4559c59906964c3ab2450f2d3498809f941a5094f87e5feadaa1969202926390a1220cd3cd9940bd2c6077d0758930c6789dbe69e8a2d1e8b1df18ddc730685f102a20751692028920dfa34c249c607ba511654520613ec51107bc9168475a6d452c1b3fd4a8be96bab83e100a406a27735bf033cefaa81737b88466fa1d34eec15f38966a3bdd13fd0984ed13a30af8edbcc9a4e126efb94a8ac3e26b85b9773aef3275583518dbaa11c95e54adfcef88fd5fc5ece57a6e1b9ed1bb9c7774e80bf1d6e38ac96419df3fec8ec8dcb971443a6eee288f08c1f3baa72716341dbc75b356104498ea15eeaed077b001eb6be7cef0c16757d3bfab63ff72f58113afdc4164f9d6d42edc89219320fe4faa0080214820eb60d3ed5a03ae97332a633061ed68c78dfaa5e3022634f43448d3fa88344b2f0d653940e5e0c01412d6a4508bbdb55aa0f9fe79f706af4f5f01744582dfe8e6411648d3b1441651f3e45654b33d4664511df266d468a53a52e46bb49ad97a8a5b239231bac07625babad063494dc2a099092ddf07846c736d29b900c268acc1f044c55668bdd9611e4b318be0f48d51bd5c2d1f87e5ef481fc9d4c02f53a49a39f5b23a7796ae0cbb9a037b69cc67a307d7711a3a7c20cc2227006c8d72db02998266630fc832cda121b95727a520cb8ff17492fce87f369e704bf05b55d1ccc794b37013eb7a6f80b09376ae3535dee9bc21294f624d3a40a422cbb48deb80d2d5fa8fd2e3c4194908231f4577dd1233ffe97f448db6ee37850aa8766ec6f4589f3098504b4da0c0cca5665a7d84ff82e4be446bd852a30f5e347a18801813c84f3b19470707a12de0577b0eed782b3d4602e4eb8f87faaa6364729da45ff6423a48170fde6a4deb6dd7f5db5aa6b9b6bb81bad1d761eb5f4dcd51549e7c64ba37dc3976838fe778540ddf264f071e9c06ba7626cc2313805ac36a534d8b21af77bca84a5d7fbb750f6c93f06225e4453cf9233e652f383cd4885db384dec535c9609e64e3526b06323adff3f5584dffa8ab4e41f3ce546cc2a1f81cf040a82896f6d8419a5ad8f91e36aa1b89809a812f51ca0575d6ca88b30e97a3a6816fe825148456341123e6accfe389e087ed0a38ffa48928bf438dc6359959431a610800bfaba35e82072558cef06dabeb2d089fcb20926ad7c909688855b2c7af757e64e4b3603c3af4e67809f9abc5688f82eef23d8663f3f5885c4c76098c47abee1969e277caf7350daa39e02277b5124bc455b41f576efb23be40652fa3750075aa88bfb63978347741d77efdee423563888e4b076d15f2714f1cda1d0693a47f9726607de064d8d0d594b309ac39e3a86b44febc85ce8966c014579eb6905522db9b679e29f995b36be3b9412e4d384d9519501f82a40bb4d22529a6b7367d29d8edf7f731f5791eae346ab1c3117e3acbf47afd446b1dabab58db5e2e29d7efb89fe4a99c29d3a5431ffa35d69b1929f0fdfd9b64364c37f9f1293fa60c8f5111bc21118932b0a7223fdb680aeabfed90f25ac452733012dda1daa631af5d6336ddf743ec1fb5d54ea6fdc9f463c4574f2d38e9d372f16a6fccf6f92ea0aa11a2e92df273da5876d8f59559626415f622ff6d60116bfcc53d651470d595b622c277c3cbbdbbea6429d915e62516cbb2d4b7c8431abdfa7945727ef046208525c54c128679606af8b290d52d9e2248033c1602bd47bb2c81ce5a0305bdd2312eeeec21a37476bdad5d1d70d47ca0bc1b2cfaaa121a1f3d01ae3fee1e16496760d1edecb00e0a2da0ed66b0996b45f506c04e31e842aac320263518218a23dbf3994f3937c80d1fa522d66da7adcc044c796be2c3fdd20d927d6a0d186ed13751cbe7abbcfffbd08f0dbb542abce8efc2b70d4b9d2f740984d7b81ea164d0033838f3ae5395c17b56d55af6e599f720f00ee06092304393a4cbc4abdb367b48024e2edf22885fd0a3154f9d33253426c213eb5a46135eb5bb1e0a39dafa30b08b466f5738fafa3c0156e760a04f501b8f8f1c78037b73b178b53e9f35ea2dfd00e10590c1cd45f508eed6b8cc5691f1067becf0e15327a911249209f3458d29a9da05e1e462f160b00e5a9a8b43e0aabd2cd923104693f4abdb47ebaa3776982ec537621971d0040c6075ec90d4173813de802339c960cb3834afa5b9518803f41bb3dedf9ed58f32805179305f080ca72182c015b21caf03e0a06b3582a7ed7c557bd9da3fd2a78e7ffc5977a77701af3e49c03c2cae49bbbe501cbdb4dcd543035af781d8a02308b98209e08b96a581eb248f0de439b202b4e3a2246b938615b6473ffad2acc8728948c7e7084cdd3c609c7a99189675c5e67460c3e20da7c2ccf55c8e447fcd46650ed010085025437cf1ab53993be638416c338245b39e4b754bef2df63a94fa02f99e1b0f0f6ae6648e31e59053d2d1dc41087bd5a0f65168f2a9bdbeaab0f24b187c22bfd874580b18461bf5d6e9b75df8f4205ed6b1588d78439ce8d034881da59738b2926ee1c8447cc55d958810077ea78a320999d8ab6b099519b3f94434544de1fe28585583ecfec1d70ddb97988e5993131ba5c68e64db569411a2a08b8d9cdc83f973c2596c8d7b891649449d422c9e8201bff41dce681c673f9d6e08a5ff0a15c4650ff7fcdb1f2bb82426951c84e60a793674a38253d317bfb08caf2f827bdb2224730cec23810e4950945fc77a2c0b4d0cc42b80566788eeacf82daf0b7c2597a97255bb77dbb7428d40a9c7a363416cc9c8099a9f7075ecca8e1e8152e1f832d1abc614aae9c52ef7e187229ac00c0dd4366fe93fe39b80622d332e4cff3e9f5839503ee330bb5a4ef9cafa1af5284e1be6855d637e5f1007d5075cb0d85ae6d476d3f55dac36c1686819f0441b3e8f998870d3dca3110ee5381ab4af04d511864c";
		String expectedSig2 = "00000001994b105a9224e5edcbc265ef0a76939005cecbe87097134c0b52f1d1a41270c27f5a907046e7377adb47037a87a960fb7720171b498ddf643e19f00509155d0b60ed5398455b6a330742169e806ef52ae037dd276ed1e23b4778c00eaab199740408bf55a6b2f3d432be34ce2d0b548d4006302d941011cf1527735e45c64163ed4f16900193916bce6471a4ac8c769655f44e3a948cdb98cb9d5a64cc30d71e178203bbf088e0a7eb816d8fa73551c8bd5f82cebd41059f86a5d2dbe6516af2e33aa9c5278892aecef0c6c7f4f9e832429e363016b2f5217ee2eaf7949f94c89bd9327a2efddfd762ba2438f0f54f6793de01daeabc02e5b0ea1573009ee98cd77feb551434e69109d75ba574b8e2836cf12d8ebb0b5ebb22f891c0aba554212d77977099d6089d1033a17d7bcb61a472658ae136f23ffb19f781921276b33f8661a050d4eb08e16e4f8ea0c14339d3013d52152e378054bc83b58315fbffb6e634c4608619c70c2db3bcafa8a2492bc7aa11990960a62cff4922f28722a01edbfe6e597ee9da5a4954f480bc561d90524c2b20176f5c8813e0a40ed5fa2aed74ebda6315f228ae7a6564df44acefca107032dae80ad7423633ade39cce10b042bef01b2312165993c1a5001fe1b0fc98c1984a8521a818202fd0173d60751ec5e44825122f0dac6f40b4e81827d41e3d18accfb9497693ba831a05724b491c82c5932004cfa18c6b41324d9d48a5e30c5b1f75f3ba35f55768c8dd31b513764719ad3acca35e9e894ae8c2451dc84e036a7521a907e2518c78b348be8f52d72fae8ca20f808beeb6b890750f5576edfa06100b472fde7219ecd97bfbe9e0407de3711543caf1cfca473bab17b04a9b69e1384091bef61c2fe29b6ddcda94e1578a1bb6a735c1062a837691358343255531954eae1e1a9b0bf2c3c68313fad59ddfae9ed5b833da1eb9187476436f472a0c96d6650856238c7185c3f5c82640f5af3214c9c504e8ba4e24db98e55e145c981828eaa10f44169ce97da72be304eae54a54f7fd6827dfea6f941a2553fbf18e6414d8d46b65f968d0d3f83236fa756d43917f6d5a7c45cfd64d166ed5fa9ddd46051f51e8f873a79dc765529a2bb0a6f724e898ab24875223ba8b4a4583b6635b09ece4b299d46768dfe094e37bf25eed04d375febee8e8ee598d07e1dfb73286d46c1af5bf96e241c74504bbe1b1d807131d1d6c837ee4064ddd276e8da70ff49fb2a0322b36c89e9eb4c9d96d0b7facf38d546abd98be216ab7015af837581d1df66414fd19c595bc16928566f47e4ecec0356b7f952de19ed7ba2566c0ebd369099906f0876787178cdf80fc19d2df965af779e110a82084369b67ed88676c30490a97482c16e5358935e5ddc61915dab61432754e2bf72806e08abb2bddb5dc1af7cf7957db5a6a3dd228ea89d13f1262ec9f648d4972f01e8087bc5c8b026374105e15701bb99de2ae6dcdc7726fc8a55e3f2a86d9b02959741d0d2eca22d3d158faca24c3f99d91f10aa26d096226e1f517c62144fe47f130610daee06a11e50c80e7fba9c41266bd7a9796445c4824d540c93fc65ba84d7bb6c2653926abac85297a9ee945fa0f5cf81343614d606c9002a1b501826ec494e6d33e914bb537ddf277748f9746d65db13f217faff765796720401468ea904026d2444fb9fdddbe0437ce0978909b363aabb7d2e5edd340cfd3114d03dcba740689d4d1ecf2bca9cd23a50c6639d69989100fd8c523ff2e6704a20d251f71584eb34c15d8fb6ad5edbe6f231bcaddb51e11b85d479c6668f77e9b08cf8157d805502342f83c91c0b70948de93a623b69dfa431440144071a8ac1ce1844fb72350559dc08a379ffd1bb86c1107f278db075ece94dff437a3a4da9995c25916a3d9e8c340d538265f792794be7639fa8083127820b885359776f7f4d43e772b2bf26045823eb8d844cf5e4900dd8be2ac62c76df20790bd7b3fa713164fc32cfbd7d6c33830e3c6426a9d2bd92d44da5ef47161b9e3f12aba79b2878db5cf85a4bc1e1b1c233fbe61fece7fc070f417510fb961ebf32443a00ab7d9ee97685497915b2b7f32bb0a47e39365b4f0d3d0bdad105c1fdb880fda5b8071cda496bce9ba9b84d04be3cd477b8e6c0aaa6168bcd09ea87a69dc932148f68be872b441f74157064aa36d2187e241a787831d2c7cf4ffd63b3564112de8da25a77dbf27f35e6f8473af89c859a9fc9efd1ebc4a8301be0b989db0adae83a8b967fe7fa91c4fb334ab89af3d5c8a7510ba9ac1e450de59049d52c2513023f5cbabc2ff31850f7df591341b6554f7149e06d6b188ffdac1977787600b854ecc6f7030dd91d3d6de3d828cdc2962f653ffa1cf26326d0e935cd5cd18775821b6b794bc9253d1588c70b067aaffce6376c330aaebb22dcd1069f98c0d963dfa9e6c7a5d9722d8cbe4060d523a0aa1003386aa092a426f31e22f2ccc8c67d5e489b5b4f901e3a3e035cfebda6fed857f40cc4ec75f78d931d46739a8e17c780e8112e621d2ec7d269cb45a04b08697c1c3c1ea7cb2fd2932d5f023c9d35e2ac23ca0b9cd0da7eee5e8a4f96ac6236b01c86c25719554fe0881a71ca37f1432597dd78cec11794cf45edd1d6e92443638d60087a4023eb51d4705f57fb577c44a3b068b6be25070c85226f2bc45b796be86f444572ea310bf319a501c4210e74e59dc1f71b5d293350fe2c7648fc46f031a204984db969d131a48985449ced99c5483a201175d8440a47ab3a923ab5a4cdd25c2fd56869aaf202dd5a45b48d49cc41550c74eb8bf29ddd6e77830f48476b8cb42ef61e901df6ee4e1f179d9b51efd1918600fcbcc6b4219944301f00cdf008e93710e2eab3c671c25abfe8ab34304aec682346053db89a9ce939f72f7c1a389f3c5197a72526f994d8023d1a969a35115006f9ef6b7af40c8e949d595a1d83aa3669be98cf2bc49a5ffbc69873cca7f06f2deb732f08d9b2242b478cd9c7654c6229b9fb339d7ecb542d056c109e83fcb8434edb79222298f0a5513f915cd3773d8873a223f8ba5b2d2934fff8302e88ee8c6fec5456a05676c14a53ca7eed5485f4e4ea42198c8447cc55d958810077ea78a320999d8ab6b099519b3f94434544de1fe28585583ecfec1d70ddb97988e5993131ba5c68e64db569411a2a08b8d9cdc83f973c2596c8d7b891649449d422c9e8201bff41dce681c673f9d6e08a5ff0a15c4650ff7fcdb1f2bb82426951c84e60a793674a38253d317bfb08caf2f827bdb2224730cec23810e4950945fc77a2c0b4d0cc42b80566788eeacf82daf0b7c2597a97255bb77dbb7428d40a9c7a363416cc9c8099a9f7075ecca8e1e8152e1f832d1abc614aae9c52ef7e187229ac00c0dd4366fe93fe39b80622d332e4cff3e9f5839503ee330bb5a4ef9cafa1af5284e1be6855d637e5f1007d5075cb0d85ae6d476d3f55dac36c1686819f0441b3e8f998870d3dca3110ee5381ab4af04d511864c";
		String expectedSig3 = "000000029200f6d2d656430e2c49eda24923d91c484885f9e626e8e76cad5fd2f7d875cc409ccd761de3f5e2eeb587f98ffcc8111e9d530d7c178183b8c0936f1bc16097a6513bffc520ddf5fe872a32447eea05352e27e4c7ab30d494adb36b6f004039a44006d9325b01497ffceb80c59e558f64aa6b2ac238dbf0950be637940477b8e8d2115818acc9e3aac75e1190e87bba33b8ce9226e550c01228d642ea3a0c37094ec4246fe0c1e7b79c7b8049bfb6162de6d9c6368b3f937ae8286452f4a3337fd6bca785e8d5957dfa18497681ab7872100d8117e5d039593460607f9260dada15a72ca7278294bdb001d0a1fe754476b65aef4fe22d91e44f6cb15d5ad33ba6753619bfb0b336f89f8701ff80bbe3a00c21d8a435eb7fd6719840e9e795ff659589f21b9e9e936c83232ed84fb009a0ad3892915108ecf58821817609f02e1581b9641135faaaeb3f3ccb5d328f6e0e527f333cd09044b5674d7d0fd1c189a2614a0ce063c3cb04a94118da8f188885fa48955331ead98b75a5d2e9ef16103bb0d9e99c31b374410c1ebb902ec63c2c236409257293e9ed5fe747977dc90ac9914c474322a23ba86285f15106a58897ecc742a5e552e5c43bbdcb2ac80f2bc46a5d0fbe9955b90b8d93188edb10e9b75774fe43e5cd9bf57e5b8a741b1902f5beb3c0e347a0163237046533496eaf5e20b1475f4b1f1e8ea2cff26c6b085417133bed5db45143d5583d83e8e4ae71b44265a2d539007629ad279a3e65a456e1312f07c0e7dc3a53549b2d56671cb012f908318386787929e125c7890f220b71c242b1ff9a5a8c62d74625993c90dd6442bf9eaba85bd99a9a94c094ab3bedd18f291a9c1ee060f27559ebb091122e975e628e03a915485f3c953e3f813de8f921395e4d88eb376aa2acc0df818f3bc362d4ca1dff09ff3109d093f1bc44101b9ecea6b10ff0539bee65332546817354e9bc3918a70a7f3ce29aac0f63828ef9e5d5df57077b20025af3ba2180c394fe4d01b0bcd3119df93adeefd35d97b01c4ce352a4fdc13ac509c46365a8532133806e5cc590adfe488b021870cf8db676b9e0e43f1c8595ccc4df4fa88e5865fe996ec8562dbf5ebe61523e607640116dbe3b739547531e6417ded556c16bf13c86e9b7f17c2d0c21ce99c2e571cbc208485177d4d2c2a366ec6093d6d7bdc92f72c7b423672018a8ac90ac9454a81142a1658bbd27e2d893964181bea4bf97c90e0753ff8f0ca094afc546a3ace06c765424a6379149aa6bf01c4dccb44b2d36753acf3636d5c380a2a603060775b36c21446a066f773ec42cb9b85fa382b4d769277287b0e32310fe627f80b47f4ff9f06e6d7ccbb6994c3abc960f909c59006a927452f5479166a098acb67d4b3efb7471f80de973ac0846a76c428e992cea332ee592bbdd7034fc365a2be472af6e8f0e2caa09c097a291c7f070e1b2805a26d9906a3c9f73577534fb109f3a5ed3bd7fd30a19c7ef1bb97b1dbecb5ed0e5b1ee65b632967729a6e3cc054601b63b9873c760cac3aac3ee17092e4798056051a8eae8eee83bb2fdfea92b0ed153870431707f05eafffc6d6d7d39c54a75186fc7b339f3c2bc019d5e8852ad6861c272fd2cb45cb30a18851bbfaef8e29616d2c4fae7d831984faaffcea6f7d2313607ce49ead757ff938b7e7920719d348a690c43df491f6bf6358ef6efd265171b140f03a1fad0f8e799eba84d514a9345cbe7aecf3f4d3485bbe328bad6f9661590bf0c4f405b6f7e043ccf0de489d0be82c8e3a7c32a9dfce2ce9258c72e1c4bfe7c74faf42116f19c5aa37a58a3dfc80b57191610348565ddcfab4720c1f3ab34d03ab960471bcc17f52f3ecadd3d06116de9259b4bba81e2773a401b792cdb4b13f393c64aa9808551d6c8d75a0f49f6cbb7c1309703992358fdc20bd0b036fdc46128a9f084e72503a111e2845abe714dd5574239fac3605bd8b5d4b13c63396da6fa93c7bc470fcf54dc039dd6a7e5608c2754b15eea359815c31edbdfba4b70c9744397abb82873d6ef262a42d154745f52705606c3dc4ff75437daf1a7a9343a97de3d69fd9932f898a8152baa639447ca3335f62816cdeef96a5aa19452be9e2ac2873a6364fffbc9c70ae355d8d20c6474ff7aa4a1f693ad3be4e4b244649a371ea2031b2e4a4b4648c22a62d6877a9658e089efbc5859700b7fe23f9bdc7f47b06837ca4b01afa0ef224c4d8138d4a101535227a0175a7358943d4c4d36871de51ceca7cf6ff79f0c7c95c309200f17dae99ae5d15cbbae425bdc4a769915776080d61ae7fa2e208ca4aefc72b674fbe863624fbd12f6e8ab68a09d1a8e5d302ca5b7ddb2b0c180bb1e801807ccfedc3756c46a8f524fca39013d8d41918dd5b05b75e665603642410db10d5769ab81813134fb8156e2198acbd43555a541994534ae00a10d86b8d128012f7bd714de7e0bd807bdfdff9e346151fda157391237e554043ad24c85e3ed2204badd7840a45e686ca8af73e0037588a05416773f4683af9b6e0e20765a81ac5feb1eee89673801394a5e57264d958c175d12dd259da7de63eb40c2896f104e6f0c2034c1e995d6e6cf6dfbe1819e8fe4ef6ac62d5f6b767cde329cafc82206351cf6159e049e8329ca44b53803f236772d3667e693ba282144b6126ee8ebdc4f32f50daa5a836423510137d0241949fd07703142206c574daab5489d086020b2f92f9cafeef0334895f77b056fe274ef06a9e91d4cbfdd27deea1ebeca9a46a0d13a2ae57284a5c63c5b85c31bf37e87df4d130cdd391f8498383b143855874fea2fe2aef89754f46befa43d02a63349f1c4ff06ce891959b6dbc9471723d37aba37d9cbc1d72e8bc476d9cc041e50026015253290144a4211e8d63da1cc8628b8029b9cf6a6bdd265927e12a53edd8a7b1a3c9f8014138ceb9e058ee433285bf1a1af8201c1a7340c494d712d179cb516f10f7bdeb78d6ff4b18679d9e22b216b5366e3583dfb860de819a68240994f89abad1d9b076c4d5635fa6a98a8865e528381e2fd243605a171bd2746209a3ce8f54ae1256a443a5d922ae34eac7a2c0b4d508da63ee53231f832f97551444d63abdd151619a1398e4fde7c30bf8502d9856444e8eba924d7faeddbf3ed6983ecfec1d70ddb97988e5993131ba5c68e64db569411a2a08b8d9cdc83f973c2596c8d7b891649449d422c9e8201bff41dce681c673f9d6e08a5ff0a15c4650ff7fcdb1f2bb82426951c84e60a793674a38253d317bfb08caf2f827bdb2224730cec23810e4950945fc77a2c0b4d0cc42b80566788eeacf82daf0b7c2597a97255bb77dbb7428d40a9c7a363416cc9c8099a9f7075ecca8e1e8152e1f832d1abc614aae9c52ef7e187229ac00c0dd4366fe93fe39b80622d332e4cff3e9f5839503ee330bb5a4ef9cafa1af5284e1be6855d637e5f1007d5075cb0d85ae6d476d3f55dac36c1686819f0441b3e8f998870d3dca3110ee5381ab4af04d511864c";
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedSig1), sig1));
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedSig2), sig2));
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedSig3), sig3));
	}
	
	public void testSignSHA512() {
		XMSSParameters params = new XMSSParameters(10, new SHA512Digest(), 16);
		XMSS xmss = new XMSS(params, new NullPRNG());
		xmss.generateKeys();
		byte[] message = new byte[1024];
		byte[] sig1 = xmss.sign(message);
		byte[] sig2 = xmss.sign(message);
		byte[] sig3 = xmss.sign(message);
		String expectedSig1 = "0000000025fc9eb157c443b49dcaf5b76d21086c79dd06fa474fd2b1046bc975855484b9618a442b4f2377a549eaa657c4a2a0dc9b7ea329a93382ef777a2ed402c88973de1050172681fab616a2123e84cf95666cfae1434d7b3cf64c044ee1a4d0a7815c2873683af7bfa936a0dd9f5eeda84e9c43220f7ce5df2319c73738aad1832688c927937f550f95038c9dc5bc3fbccac3cb799ae49a274151c6c4c64052203e7c2dc7a862a939271f2c6c448e7fcd68adbf9bdd23ac86e28c3b6307b12848e8bd869c584f23d4481201e344bdbc983025660d0500f432d790fe4c1b134b66b52db20735e3ab60efa9864d4862cfa08f34716dc25e611680de3b543879c79e3156f30128e13bc018be2c58320e1a52e3d971adc6a5bca2905472d853544eb60fab22407d277f04870366908d790fa6b124e6d595136cfd51c03102ff19be87718d3939e9ba41603967338d55974b15f3b9720ec12aeb61a7efa78efaeb144c9c7db28a80df8a76afe13dc6b40d366ef720f70c76d68094916e4ffad6223b2925e95e9d79f435527fbb0093db225bfcc2c6e673c045ccc0a9586422645294208effb9e85696247ea45b8c81215a096b118652a5459447a9e1c7939481d2d2f10864ec397613692eeb4219d2ebb973bd4844eaf4deb824917da688f1a4c922298ccf7ff2caf6d53fe7428d0a6ff4919fa9a5d0ddb534016040ffc8313f37f3d1e9c9fe83e433df315d569133badb4865c53a8d8c0675ed1cf9096fa3b0ee753fa2a306b702f076f62e4d27e446f6bbb1bfc26814a5864475039939bc2c66a270b439903bca6a882c856240665274f16ebdac562f4b457be32c2bb6fd763504081bc2fb02c494459f416549b46c4312859bb2c73983d436c203567879b5acde933a904240e997ea2c66c76786c15a4947663ac019a74712c1713f8a86a60715b220624eb6549c41d98b389ce246625047d3c764dea5613a6fa6b894b8e1d0f1967b6ae1082f774b184aecfc6ca884a1d8480ce256401715394dfb65901507c4d43de23fb75839580b89ac4aeb7f926340f0909ee1ec99f438ad7d415dad85e0d281d43069a98898ccd797125daac612a476a6b6bd20f5da6447ec2c6f6158f65c0af6f594060547ba003324e841232f67a9142ddc20092d9824d3d8346e055dc0e5acb1b88b3e182e09ec8beff8f64208e159df1483842ba68828e0e44f1b2baabce97c933cd9e4994d90dfb3137044d17a54e9bf1a9f2b887dcf6801b2209dbe4a19e57c825080c57e58fa34a50025922daf62e598a9089990bd090a20b70c819d4378356f41142055b5e2fee1c9bb5e7d9666da56975fad177744e03e3831cf292aa1ebfa05c3b3cab9161911eb2916a772019a6169be70d3a1a6cef1500e24f63c6c21fe4af8574a4c08dc6ecb2a73951efd3d85b548f223627fa788f2483d8db475197560ebfbd5693f1590872684759269df1b092d3f52b651b9765591f3b35a0a09c53069c5e3f341e14f6fc8ff650becb2a3e5d91c5d08904f002d1689f7138a5f87998b29ecf66c5fb1f9df4243f0ece2a8400a1c7aa02d709ae33e0e734c8f8e4d04a10d7c101fe8dfe63ef0ffa69039e7160f9817b101da9e605f8bed1f8d9acce517267995dcc629620ac814435d76764097a972d03713c2f521e649903c53c09da1ba017ca4e1e0f97688a82f62e5d5e60d3f6e67cfb9983581a0c75023a0659e3851016baf4e8e8583c84b3998262c25c44acbc37e803c6e7b9e8b7de14873c9a4d44b84f758124d0bc10c0980ee92a5fb3696d4decf9131c99324fcb2143ac794731d22b8a56d699823c0715507de91d7cb253b7e72bbe564871a6d1c42df2dd87d78d22567fab95ab1539c957d202f2d06d563a2c069d29401d5567d631c42b5d53cb0ae1d558d871eac8fb4412f07bd006760f58f99a4744363f1d6468ca8ab5760d8391bf8f41a812f58340866089a6edff40bd9d577cca764d8d8eda9c638a6190f9caff17755581844fcfd79d4e2555269cab83c9ac356013f49c94563844732a0189a2cf276fac20f416d1f141e38919a9883579f9b2e5475abc1dc556aef33385ec9e72979a3d45353717ee9f47a9415a3820bce6be476db59284fa883718b148335eaed20124e4e4b8bbfacbf54e3c3fafb444014d7ffced57eee05aaa60c5bf4aa04ab2772b521a5378cc87acb5853762f16bcaa4b506320e807e2e4d6454206facd407243d53e99a7b909f9bb92cc440844add019a0c8bc06b4d0caf71ff83189c4bba08fd19800f6aabd41f2afbe090a57f331a625d3a410c09310d043d9cff10ffb2a23890044b1bbc2775172332a0413a4b9d412d1fa04bb9465314a661e67696dd9480974de0784e85c97d97cc4ae317d7af57966baebbf6436dfee1f15f1d1464f4ee3f1aea5b9e52d0fcc5d1f3a9149a038f29e61e9de288366f648e4c88b9e703638f5cc19d7e5efdd1841cde953384d3bd3d0c5eca0ec11a383da61a288eb411bfabc9703fe47ce32c4a237ada61bafe5f95a7af592c5857ed08f2fcd80fcc5aa470bea044fc819afbb47af9942f05da915e77a21e74fa1390e2169f5be554355070f61c8c4840abfae539b43af7c091603b4809e2577a5ff18db09971018d3dca541bec7934f6e3621e6bd6945741f53c2240265b24047b72f5cfdd14851dd1e140ab6f70d8b0c1d52f150a0eebdf4d7065056f50c04ddd35aa86e16d3a4b7766b785c15741c82d60fc14449571cf9dd0dc55ecbe8e5d4ca8f52fd284cfedc93ea39ef75cd34664cc25076380fc474a03904d30a2e3494ee8411cb97631bd4562acd34ff8ba23ec1272900828f63dd54cf3b94eba1484553bf382944705009243d77ed2ec26678c99077ba2357dc61f7428d8e61faa02c3cf949fa3ff322aa5e2d2adf555c2540d17b4255c9895c9ec3c6abc4885bbb5f570169f4a467a40028cc19af843d6b80a1dd0c9042da34babd22c84d715424da481e36657aa936fc098989eaf89b8d77ccbb76324d3783ad98accef83ae0f2345c1d7bc3a6e5558183cf04dacf7897feae8dbd98574c2d2635bf0b12615b3c3a7865349233f805d9376161c35b6150dc789adb78abf56d5b0b47449b064e76c4dff9f231005fa974d3d703bc6bbf4fa061c23283154055646f33ea7d73745637e31f2ae8096f0b4802518a9c48f5bcc764a5456ac515a49ff1edbab810c2148a24504cb601738fddca276843eb194d6eb3c2f884576781b0156911de7711d86f6514e3d90190528986c02634461ff43c74170b0a5c157053e107524f5aad0e8806d13248311a6865db7fb0ee8c90217ac0b54a0b1a8d82dbb370c68ac93d7e673cc4d6a5dce577d4699d67d8d44a6a24d8dc201d3c08e59ce7d5994f7affe2e8002fe413971d884d2b08a60b910247009a746c62d483d7f908e959b369395536da4a9ba6ad53dbe2a51ee47bc60d581893f45cc6b8edcca2832c7d70d6564bba4db6e586f51ec217c120d9e7369e2a8fa6b2c8574265842c32ee59e862f61b62ad087bea90183a11f81074f64015df19ae273016eaba842156a3fcfb420d7b7b37559007b1f1c152601fa76402b2f5946fd78c160e6542a3ea6a29221aa552d1418257917dd309bb7b58d9e34806365247499b6c0ef57da67d3bcf8b6dd49b5034787b97176efc546da5e676830642659171f663ecdfd7452cc8f3a058a793019fdae532b2464631c903cae9c3115ccf58d17cadcbd934ef66446a0d1a47ef659179a312e2df6aef19fe62ee1617b6672f13016a30beee895df13b124c5655b4dcb43a698a1c4e268f3888e89456e9d990eef11dd1bef795bd1ada61dc1e9374b14a4187235316c075a94df847a936e08748863f6ce969b76be57046d0976747fea87c4648bccc8ccdc8e8e596bf0d6be5791f257b0eecca27508dbda59d9db811bc6aa490654840de6b6d85a48124a70701815b988c64ae70f2b09f1f272af75dccc2dab9baa5f7b51802382144311050585b2b9bed7bc81d7354490afe0a1dfb95df270e96d3c81bac6bb7c7448d92fc6abd2b01ed06093b17edcd25e7034bd424984c2a10ed6433de0ec246c7aba4d0228b6f99a46bf15b361e17baa7217c89701a26d87d5a5bde1553b1c6725cc64e68317630350c1d2671d29e8b855374b293107e6c089f1a156ca1f708a4506cd75a5e4687195d669326096f0b16bf5a15c83e79099a28593d619ab4f5e79a385615e7823f1775e6db3d3cdc6c7d3459a0f80e0ab1d321d1fab23ed7c978a0e35d945bb3983ded1a119135bb5e85998497190e4c1d7b27872bf89e9d3785e98d9645812ef56aa66d7cc5ef4ef59aa0c1af3b1848a7f0b32640afca5233ddabfd467e9c33eac1aa1d3ad4bcf4d0adf43c9df5726cac99fee0575c76711f85c713d9d0686c9b97ae31b1ebc748695c8755d1082ccef338f7a2ba1799683d32ff596133d20bbf10044605080183f856c40a3716bcc31557e631ad33c17c782212167fa28932efb8ec959c168ef074f7e8ae6e3a2530b80ec03019eea613ba748eb319621dc448da3e49d079035e0f7705e6bff9b250ab3ac2a2fb1ff2f02f62fb0a88735171032fa2136184001d50f9f915b28bbea95135d30ab3b233531fa81b08a4c541c34885eaee67b9c87e6712e9b3f632661547a289541040fb5c3c0f5303dc5966744c28b2256f3e23101cf81e1bb4bd1dabc947aec7eed96f02522247024420f5e9e628a67c0ad68457e48e47c9f14df6aaa49fafdad3b027fa29d57f219c5fc13562e77fd20cb11287122313b1374012f73f572cc764f89fd5933631144762312f44d4b247772f75e67104555926caf31f979c02c8c898b4d094ff30a0bff1a664e2962594d31a5960551d0372d4cc79267e8dab7adf2cdfe4e39c3cfeefaf835ec9170443f3aaa86cf94ba4903a99e9c087155e76b53facbd3d4f6f4c46e58b90aaeb5ad8bec198a0417d09e127dc2d615724b8405a34e533f096483a25aff54107d9965f38cabb148e6bdd6b145910e1a4f9faec43b70099cf698c1478ec219e4930c31a8fd5625fca44395b9d6fd01715c0ea330fd83f63824e20e30ba6c1a1afe96f991f6a976883b330e45dcf2d571ea50f9c00dbee579e271d43de496120c3b72c511f20af38de8e1225c57cbf0266027ab37ae7f2ba035da3a109ec42bac37e2695f833c94efa72f209146c507a1eab217f4dc389262c3375cc8c199cf3ecad6130f373991a0e45598a22ff69e03ca3914e579eee0d5d42c64faf45c58f6c3a6304bbe8aa1f9adeb712d6ea247b5ca334760173c3c4340aa58954ab3dd42cfb8163a10f72aabe70ae8dc6a5ab89ca616e99a19f4ae4826f71a9154a77f0a4ff29b7eeb66209ce3ab7d9b1ef2f00f480ad10d76744c377d2b5cebac2c938e1aca799385b8fa44472df2bfac536af923e5f2164488fbc907528cca984fcdf58de31e86041965617545a5b59655eb155ab306e0959dc93b623864f8f0f73a71f3ff839775e676afed5c675719662166512d4952fe7e4b31ae0e7eab7049dcc50ef9a9b076a3d8fc0faa7c24644792e4a5c374999da1c97ff01f4d2e2ce0590ead973d963c98d45fe75a3649fd8bef90dbbf5e00fe094784ad54c69378f2d26a646ca9d4c3d34bbb7e6f39ddeb650bbd05ad2a09815f75f261de7246afeaa2d7b17f518a0f2dfd421205c4e4ddc57bbd83a49bf7c8d8066d491cdec07969f719414eece2cb5d7ebe7d04e548aa972dc329be2ba965326c28e27ac7819bdf4b9f0b0d4f0fa643770b87cd192bda6faafcb9a357040ecb2298fbd2e3ed4d2607c923f1b0b992ba4f4c2b9130f1280ab6ddb6a8e648fdda5178c5e1bcc1ad1cf388a98ccced0644a5ca6fb9c99af05649be964acd406e33d2e49890828367dfc9952583df4846b85b0e5d4df443f0053d16647161f7a4b92833fc045c8b136e57dc81ef42fe6d6bba6419cb7bd74b545c1a91128046d54e7456901c6eb9d64acc52dd209adff79037d9d7f652860ef3c7f7b74155e862bcaf37a58a1fa1379d5faeccd97ffb3e1f2ded4d268b8b2112f0a5db524e95521a58d1f5d96fb35bc79c9eb8deceb455eed8c757f2053a386858ab8c67c3b46e148213adda7b2c71713826cce128a30cc9af05d9cc160856daa3f215d4ee3dbfabd231a5dedd60395c005b35b6a3dfd7be19155118095e9bb4b12aa1fd9e3ab129da25e571e41b7e35d6e442c8815cc7c32c2e2bea34467494bb8a6169bad610d20f62c2fee042b02bdfa47a7bc4fbc56756718e5c9acd0144b0892016f82b5d3a43b8e9db8c23ed42604b123f046d029afb3f52778bf6d775bfb49f36604ede2435c6a157e229924ddfac254cbcf42b41cf3c553bdbfd69c8f38ee5ab03a01a127e57260ca2b2995b03ea970c2091f76245c2b21ae14f1d186d4275ce827dc6e95dec7fc1ecc5ab8b8b875d1403ffda5304bafde8361a2a78b19fa4bdc5e48d533a66d789eef477dbee1b5e8bbf0fd0851abd23b856a260f8299d872056071c709db060c3f74f9fe000f430ac32b5aa11bc5e5f70050dd8423376fb8e47d02191db1df91a5c8fb9f9fbb16ab9e48205e3e306d18d5572ac118c7a1d4476efb23435a2b56a4a3d5ee9ef1494eaa4dd5154f066aef131918dd35ddb85eeccb9876025f7193e0c8a02649ff3017664ae0a3b470aacdd1c9169e0663a84b811c63d4d49f46222a5cabebf85b442fd9474b63d3670b6c61599a491941f991665327654283193a974cc25c5c48fe459c773e3a8f90e170ddc1fc36438155f80775685f9bdbd716039794437a95b1a5b6e0d5e7a8705ea5c3d6097aab37d645a060db9215e0a93ee0f60aa7fea0c195b760dd5dae9a4b8a87fd58fe6775c70d5a42062c4acceae9fecd2325ebbfb87e83dc45747c526bed3790c055616e4f125f91ac95cf4916b38b05a317fbf692ab65a558b8398c6e29cf01341d9e443e2cd68288e4fd34bb2641accafdfcdf916c5853a326adae083836ccac374a186b07ccd0dcee2e53df4aed0751ada40c649b7b3f42c688023a7a9a470c043fed8db5fbf3dd53ddb822a9fb9b51080f4a1eba5f76ebc5c2f8bc6b0118a5c85246098e38bd80ccd73ab1e8b22f8164ab85495d91b90e5381f598e34981338ea0b0192fd06f7ee4e3bd9ce02ee019e32fd05c04a037ce4f31ca6d9d29a159dd8e7d5179432b54702e58ea2fe529f71b544193e4609af1720d37c886f29e80a1dc3e4ab131882b5f058424f02e67d922e8782c926a2f09b596888329d36866f4296aef1f84b75893eacaa51283fc8ea3d27f0a029b70d4765b6d80f19852b14dd7300e7f2bd489bb1693db0ce2afdf732b290142e89a7bc0d135e2c4e31797f707ab93644bc565d367efbbb1eeed3eda36295e25943114bdc7a74484ae8a325981ce2929a64f92e9ccab9c3584c48c92f25f928604bdc593659ff3f12dc28ff87ede6e492fa3953505e2ffadb008cb1b93c52d25be1a34a2393fe2b8b16a7eb6d0b650a226074acf148eea9b2fa9538616f50c65c9e1d005b06da6844a472df96f4ca0caaccc5fd6da7b3be676cf94ff97a4ac22e0745b4a820df3d1b1092a2fa99ab9fd7d2893f6f1770d7830f4cff53007835c8e4054ca118d64a73205b2153bba71b12fa14ba3d50e5c12579e1e4c3a55a4a41295adb4e822bac48e7d6d4231764f63c472b6d0dd784221d2a8135887c13a620c9dec2ff8bf43cb21abae68e57a81ed422ddfcb1d119d9cc620b5828647ebcb3529cc6c65697ac4711878bdacc5179e8258fa94efde915023d9aa25638993ca93fec89a5128443fe7bfe32272fda2f23261ccd2e7d8c323bc0c10e0aa65dc22cdc2b0ec9a56c8fb1058c0ae7e8788eb5a8e9c9b2f95b24e09e5b8de10c371ad281a922163e54938f0b5864b0fa5151973863c77f31864140a6e2a6daecca9af0f2f4afe622a5f66028f7170ac209a3eaa9e36fd4933c95c57c163f9c07dd5e6fe151a3d8b49a3663ade0c2ba94b87a0f23f6782c425024622f7c6771764db75ef445376efd4622e15a46a5a5fa889efda7d56187bd5a2aa540bb76dbba27c8781c3b8ed617a5eb1065f7c22a60333c0400f31cbaa55a93bcfa5ea6503c5f1ff215ccab912c9d2220c95879baf109a4b128d0721e66a5400586588b0740816bbc60417bfe3683e483f69ac6e7bbdbd4703396a238eb62ccc04f7cb6746152d4332c3b9879d4532529a4bc3d3041a6adfa9aa2a86b147a0ae253a728f4870aabdbde73be2ebcf9d1d374c68f36177012ab5b25bf710f39ca6586a7820e69061b4edd2f37f60b343120049851027f53a3bb3f156b9ba40b2017031fab690345060dbd14f79a91c8663797f465c5d2b865fe6351cbdc9165c2ec8ebdaa4945665950a10763de1c873a657aef68cb0be3325c2ac9067cfa1a59c54104e01c7c653a7dc9810c254a15967129928ed2ae321b585aeaa1ca4b5238e4747431e97f24c72f967b09f69513a9c993caf05f683f7975857cff2af0eb731597242f114d544bedf1871244a072f0b955077f102220aaec4ece8e0ac7ea5b7ad5452c054b9bbbf1256d5bbdbd48cbc1086874dbcad4459babd65f00b63cce75b96aeb17f9ff234ce3c6fd61bd9581362d36eb418794975591ebf743eba08b0a2a684561442aabc0bdb55852cc89c2da49ca2d735e91c06475f894f4619863eabd4fc75b285d8f03501b7a6c49148b72ff152670f14940ad01923b62899298ae44082db5559861e6a95fc15ee1c2b4839d050548023e8aef8926ccf8523dccf161c7cd6b320c95eb45d290be5193c0aea0b0fb24ceaa770e0f5e0881dc76f49fec08e5ce9b34b62e33a9e4d2cc147996928fd6be1a74a58b16312fd9443c03071515ded7a60dd59b1d3481ea5a49fc4c8aad167145f17dcdc75aca43690c92dc61bc4f3ae1c67727984e04707011743c56cf4b22d1272a5a58aa4afbe90165682cd393340b27d25aaee0d18cf16ad4da32030b3400be26dc6b3f249bb15adbb17ff660bc62bd4ce655a82a6780f363d529c27c376a7b6e0da828045419989beef98a07be5f57d0a3caf3f0a39afb499ca44ad133a4a793a178d7ee74e33878e6bb5cf368b894d59d39ca82c5d956c9ed53f1ccb364640255ea9a5232f8364070acf1a8146901d569c26df1375e3fc6ae0388f5b3e1dac6abc982a9b1cb7b027c157abb716ed6152b881c51467d4c62ed2d001a0eb123cb5b599215b18d8acbe7930e0e91af2aa9769f694892ec1d34af78a30a6aa6721dd8a9b26de8666fa12b05e9e9ccc2c942ae749a5f4c3f96cd2372c6f9b05920078ad66f042a7c4b6125cf1c8240b5b9947e5c01d96d2c32e8510206b3d2e382a731ab50b929db2033c61cc8824e8499443b31bc1150dbfea35b3be09c60ccb5b85830549393e735255a2762f6e581ac8630a214cd74ca4096dc024fecf54a018a363bcd076acf5e149551c49b7cdcdd7005c08d811f3075f33388e50f161c10616e83ffd0d188754af965ffd771c09d924651faff1eba9f66f62aeebd7ae00261e35453c91be7f47ae55336e0a88c9ba28894632641992ee5a124d8861daae5fe0b1139eaf263f4c7b7389c9b620fee69b0a774a6598889a2ede3a8169b6df8635017c30093ad7b61e0057c5a46c85dc5f2b1b71d23ac4e4ea2e8f36cfb2979d1af851c8e691ab61ecbd5475f4281558ebffe4ebd1c183ee177445130111fd61790fcb8e115a47df29fc2e62e8d4c819ba86349b1b255a5276e11c2079cb0474ed8e3e8e41d46ce9019b5e57ab28fae3b559a87d375186b4a20f06f3da15c7f8a1d8826067ef9634be04006aaeeb12d5f5cb4b060e8635e99f657b25c67f03800fa4fb5e6e7475d272781a57afb1e505e6082a3523f1eeeff7ada7e6d0d5f1c4ba49bae8e94ed877cea6f57b6837356428b8073be9dbb7ce09da8795531ab202b7e78b492a2484e867184f1563ba6fe62868079f3a625bca02801fd9c18304e5a2cc5670ae0e1f85c43a99f26944fd2e4a880b0dc40920e643953892cfd3a749f0632b618c066f83c23b41238df757a5b6c50ddcedc587ce5625d3963b2a1e63755cf359a10a84cbdb6bfc785a169fe8a9c54d25f9ca78ae958bc25df38b3fd899cd73b187acdf812b06905eb259e5d911765b719de70e31965dc69ac26618fb7a7a97cad7691434441d3096641fd6d295afb47bbda47759d9b91d74463fc7f65be6115476f0bfdd28ca5daa2750bb4e3758e6a6ea05971006a20255b483aa4ca5984fa1a591cfa9856efb9f55bd67fcd0d24e007d8e9ac0dca83e50a1fb4af10273076791245ee2300fb4291429e965e09c2a65a43bcdea61a9070e82cff4a1e3b8ce619716ba475ab3520bdc0dfe2d1330322d51a775fba794fe930ec049b30133eb414bc0653ce0b66ce6f17814ffd252f3afd67438110e6fd456cad0d588e505f7ef12aa492452822fb63476b0e2631e0a9e8faf6c1d78811dd0bb9fb973145cb36e3f827e4461a396136be978e0fd80ba4d9c8d5d8d3598b36f509c691d0b84cb7c3d1a0c998ab3e4f119143f52aa3b169f91a7257db22546a174e5301028fde6cb2221335214b2f7af16e5bcfc7868bfca328456390ce6d19cde78be2e305332fd7e2311d05845bdec16771856b792d12b754f354a5957333bf68bcea3af440609402c275ff7d993eb1254c9dacb7d07af9b211d695258cba2eeea7c76043d9e697e3de87cffec138a566f52fe779ff677963b9904df3edeaaf28b2b7292a9eb3f772e1037b89eeec636b5ed8204d06d367002008cfebde8821bc47f97e84d0847e4ad4e9d498d52a41acb5bee5874d23be979152fbdfcab6b05a2fd6a53f7a7022f442d87d157114e8dd8c8abd791b79cb759ee3b5ecdd7be57df6c1914ba2618b9059667261f175a91fb22e1c8a4781410e4687b20ce192926fae3d01365cf21f29589990d0adcc64566ff2928f021b170399b76e8cf384d44024d4a8d982d37f534e0bb15dc77f84fa22ce02aa40eca6cd4279f91073a10ea85bdb69e9939a37f7f5cf32c27fac729f0a293cc32e42a4a26da3b7ec02170f8efcad2278defdd3d2547c7f989731611124ef4199720e359ef66c6dc57df547940515ac8739b7e8d6025da8dd7b1c894685789dd1d1483d4e7067ccc00814354b25927367fb0f901a3ce65f672d4703ff6b5163343ba6dace489c55d860fd1df1fb9ac470b309aecd089bde9dd4f5ec3f9769519a23515a06633ea1f8b63e6cbd25f03bf6418469e1cfc51b4c097e9d1e1b6c871816647dbf16158f14169269233dd2337671d1a4793f5a8a3853f3131954d40079330047dcfdfb24c8c56d23408ad5aca23ba447db3110614ffdcb84c34bc01a2ddc39de74f39282d8028284aca321420797440f33fd56a8d179397f7ab6e70d8c395635db7c61e41bd7377d39f02925f771fbacb9ef05899da8a9530b8686737a0773dd55ce4b4c601c426afdc148aa4cc42ae93e548d750eb2fce1a547c5f1033d77ef1897871c240e9c48a862a1dedcd420cde25bf77bd4bf67505c58ae760b6409272a138f5dff33f8f9fd56c8072803a8dfd9633a950de2d60e741cffd400808b1f8695ea1a907ac6edd22f491aae95179809a4db13a8d01e02441b03403b35ab0481c7feea655c5061002c027fdc405acc396306627c97041abb1dbf46613ea28daa3898f466f02b2865b9f952d62f5c216250a0cbdd04950347187854a273b03f9cdc9f203dd4e7cab5e3cbb990d37e97e14ef0a5943a4fdef1f77b4de830661b60ffcf7f9dde5f3335de41c7421af87f5d92d16cab5e13f9e3e2d5343ee5279bed7f4a44215a721dc7395d0804bc07f21e0920051ebaab311153cd5a0513471d0acab3fcfa63d616028b50cdeeb207d846eda565dec0404656a71132e8b8f3b9d7da39ec2e28db3f310ae74a72f44ad83948ec74b80db28443765358e2e68e987f00a78f9d69220c487134949eab334a5c6c2da5f9261945a7981cfb9400784365f74d886e8b39634bcd4e8ec552a46313afd6ee405c97816a7d7c7e7f0ac141772a65b9b1525ee684570e8bfb3520d3d94fd1af6c8efd207b5db0529a0592319cc68eb27b205ae548fb895aea8333c74cbb2c98e89351613f3c01b6a8882f0e91b6e20030c084da44d688e276f394ef3bff6164b48187df781c199237d436241c6b462a90c357acbbe170b9dcb1a277cb7115eaa85b0f5dd183be28d41c0b4deecd24a94a56328f83b388b13b87d0f3788ba95052994651dc15ff7a853388d3ae5b3409024a1d46122067a4afd086ab499186ae93008f43690afc7be1faaa12a3f60f58f89edba6396f058ac5de05394f36219d29dae85ae57eb8a8275320dfd2cae7c45ef52b485d78f9f34fb29fde8c234536b91ac86922743915fdff4b6c7d9f87ce14896519051a252319e2d65a73f8bdabb1b14c694c1965ec3b4ea26d36eaa7a0c0fa0a8b7809a31cd2f211ba2bc3aa7fef2c9577f3ed493267f9e68020ef17b0ab82d42cc6695af7d2e06ed798af93551ecaba06fb86aedc2e7cd2dfefa6d301ecd8e114024db0d00ee0244e7d71009cda6edda072c0c84ce99501a3bdfdd0af1d069ce38bef69f91565869e9f96236fe6f3a0c052d942f3a92b0d6dc3684276b5cb93ff56b65ebceabed3aeefb7fc76af1daa894845a088fcc8c466f3342bf6ca2c759fe13a43d0e5e0f4ad6f8ff91121073124faaf72bb903fa95d393b14f9c3ffba2e1d991a9d5884d61783fde89e903a1ec28e343184f48ca4e01e4e6a3a60b7a7e63394a6effd426ee4ce6d9f4cffbdee0dc7c8cac7fe4d3a151";
		String expectedSig2 = "00000001e40f5b447267c994bdc775ce6d98b0e559cba26c4261d70927adf1bb11b3336858fe064267d0514a6d971b69939256b8ce8b3d8ba0d796413f561c6825e720e61a90e3dfe6b90e1d5d71c85a43dd8cea0fff03a251f68631bd7dfb7e88828a5f25bf20b2cbb451b0192ad5a98f6eac6e2a530192eb91865c0ec39b6c857e2440918619f69673722b3e1140d2c214970cf1bb62a6ff24e92b8746c8e09ffa3f0367568bc5274d962166d2907e6918f43fef5e55f06039865b4ce4850d96a10e38b9d6d0e7504e8927b5a3c80aaa527216a17defe5ec09f821a1e26b66b05a6e37ca1726b43f06ba6804284eb240780aadae74471141263675533b6f9b626686fafada029ba74b276dde85c810d8bd3c872f16298982cfb0530f19672b36eca9658ff53a0097f4a7aca05d8810e5b23b045f81340adcb5687db05173443b2b9125a72c4e2a9092a23a7d03b6e80e5463ddc1e1ec9d974a46d08098f34911430e42d72a260f9c13b70f7b55a271db08bb3c3ed2ded64504ef3c587a34f259a4e86f9152d320149c6a525bb979c17d7913852762f9220f5a1d249d38612ee89d5b8ff520a5cc24907fcf0b11b2f9b787248f0eab3bd153783011f1bfd0268af5a3b56e3762f8be2c1eea7ed59f3ad44e213e266c140db4552ee0e838547e28c79e6c7ceda0917458ca364fb6309db48867025610f905a56bbadd3723d68aff441ce578ac5b75491896f0ea4f7429a87a92c041b7ecab508d7403bde0c40b4453c3382770795e0d45883bb011e585be1e3dfb3620dab06c74cb11673a0f32c7d3355f6310b703e700778a499e6f4d736a4c32e63536dcdaad21ffc3d75692eafc27530f32dd446d55cf6bfc23fef767d1c4cee9e512d729382b220ad263def9bd1a97a0efb398399cd717ed7d533d432c34e068585af4bc5c6be37d61303cec005f99bb606c29ac4830e07dbe4dfe84ec7ee6cf0980d9cd9256e612f650d154ef1e29fb2b2a509fc28999fb4c3e1b477cf3ca7ae4a136b64e70887f6c444b8d4425a61a5f871d54cdefe5246cfb67654f11b679684ab3b5b51520239d65df1e8d5287ca114cfde5671553fad20dff111a90971c49ed5227070f23d79b99f13ec193d915e3c0f479c6c0a5072d87ba735f565be1e3503af698817c5a8b22022c717818614db0a6110e898d9a5f9e10304551aeadf321009cb8265d9d7bcf8c1650ed2f0fbf044fc4e3a9ccb51067d48378803c070edf031e1c30a14de502fe9b4c2bca305fc453e04633fea6fc368a71f88c0fafebfa2aa99b0f845f8aa56e7dc8917b988cbe5068b02b51988a5771a09cc078be52a97f0877571a5ec6bcfadf5fea525e5a3ff3ce6621c5a9e5de1f08f36dc28a5b5137f80460940c4262847ab227d8d89b13661bba23da2a87bebfdfef98c06918c7c2f2117d2c529a664c1cce1d3cbd5436d6933ebf0b58a2ff990aeac45dc7350f42082f7bebdac58ba7260613d490bab2b1a48d1bc8c076283fd12f5b2490f19245b24fd83ca9a70061bb524af06d4d75d1ee71ab4bf5183ef6df7068e924a29426866f2a7d18b0a8f1e7b0129824fd4da205e066697b96677c604c89ede22ee25fd79bc62692deb0641f33d955b0c16bda7c41e04fec96dcede6b1e69fd3d1f31c1ee02554fab7ef85301ee234c6b928a469a2d53778c2cf9dd27daa72b2f3ae94d953a7b1f2c084b0507f3300784dc3240ceb3d9e5b4f13fe0b151087731d03e98eb8d40800e8a550dc6fec154b82164f7a63966540ad605b21b9eea18c7e687683e68260fa5f5f41ac87388b4e165932a2dd1f1d54d02edf0b92f8fdf981a314112e646e88473d6fa9ec832c5272cd8dc7b91bd061a6693565c5fdc5907dd6882752a8c4f434fa581866fa834d5fb8ab79e1ef4b9b0930d75a1ea8a5faa3fcf3f9c6bb7488c1660df0b9ad92ac9f635aad3251da24af9451a1f6e234b74e1547cc1e4d1d7b75b6fe9e258d423d88a4bafab27af87490e2fe76d98e810f060d78c1d33aec03f15fb75a5c3e1e5a51a0ca967f83236c53be2bf9dbbd81315a7761ef777e30f1e705cb0347dff99cd84b986d0e55159d82fe4d374563cc853e16832656a946438a8716db8819678bf3ed3776f24b4365b31dc945389317284a733b847fc5b146c922253ce1d4c5a56e6e123fdb5b3734a24fd357100aad1b9201f03af5dfd87d7fec918b5b6f9c08436dc8dfd979cce9e082268391258051d3aa7238957cae67840c6d41089f2beb126512698f37810d2f8958005f0886028ff48b44810551b4e0d121955dabe632e4700e82948590a79b743b649479811d042c383e77d25546bb93bff88884b5b4dff39592b868127f68b412e483fff01028f6a5a688506a84d68229dbe58258f37b5e1e4a4a755317c0ed650895eb75f8276c9ec0e056b352831fe2ff87e04e5aa3dbfe6d0894c93588b8ec700dfbec966338ae70794d7f93c64b13084c0da8279fd85311355ae5eda5be3efab54940de36cb7fff95fab61f3d68064125ea48354d703710bf97d8625d99a854a8537c76fed01edd495d83d56ea48889d3dc082dc15a5b8fbf9d12daaafc995c3db53276538093373201400503cc10e3a1df12c34b3601d3c9d608fc1e235791c0cdc831ea58bc9d40ab228bcd38df90d6a76c7e36b91a0f58945443b65a372f3ceaddee6d8981ddd05b6cee479c82c0d965ddf21f9abc6a1f2e716e701eefc3c0ebd912ac762eb3ca522187d19374af489251d7bf799920b5cabc3edc8f8494b91a4ba2e4da6563f37c022d0e893991dcf895d6dbb7fcd8fd7ed63c3aaef03b2b359c945fc606b96573f1d48b43fa4f7a72da91e82346f88306408d70603b450833b3f89a1529da19fe74217d1d7abd16315bfe0c2a02d6719a09afd3c5ecd7ed865e0be72fe78174f8d19e63cc9c526de998d4fb456a7b3d059bade9e3d874c8465eeb5ace0c0a81a7b2041aaf4ce77867f6b74c3ac607a31b470930a8a090f27c8f4241abee45585d8ca84409464a7d04f63ee2a2b2a0960f480c370d30b2d5e9743d1255aa7556a4959f9fb28450af44b33bdd24d263cd820d4ec0c647a33f2d536ed409dec8e9a3c093bf92429aab23c39e6db0c03546ad98080e1e3f058ad1cf0280ffc6356be9de56aaaf0a432b204a1dc1ed776510034e6861d37672551699e4220a21080db657506e0784c753280172173d0951138c9d8e0962c877c66a63eef42e3ded8b36262e74cabb100184200eda1f3aa82104d12e98764dd25c8f3c014146626caca9fbd45737a1c52981ba146951544a850e14a04effc3f188a95b4ef765063865e89e84ddec10d291f11e6511d1d1228621fc97aa9999ffd1ccd4431c0d2c9e27100411c120496eb40e2e3c287e6ac2916db4714188d6bfd8a395492333e4792b1488f575fe21bcf4277f72afa57da9a39420915b6182f6633ac352e88d64bda16c4048826715b9e071c257e33af53b09f0b7a0e1ee548059ad68b74d34f7801a899085c4715ed025eb421d0812e3ca7200f566c5322dd454bfe03d3b966284e1fac7642dfd377e1bc3f43b0850b2d19f8e88bdc7f7861ef13ed58afc1bb996072a69e34333a6ed570121b3e9d96a6176a53dadc133876343764bd7ec5db04d5cdba341a0fb9168803724e7954e14ff8db3e3e06c382f7d5f6c50416a46a679964adf44f843c091283640bec94c179f5626bf38b1db05f28f687189ac4bc90be3fec40bd8eb643b330be910b00b78e39140522268081fa12f00bdb6d20a28bd0e7f9b7a4075dc39a34cb7c603635dd019b7da9ec5ec79fabe286ce6f4cae6ec7ef1f0070890515a62ce1ec98df32ff0ad3936f1292570703691c83608a47a04e89dcac2144e408009e3572de5f46de09c213bffd4fc359605071c0c49f05c4919ef68cc6dca034eca6808b919519cecd7b2c04e37086e67b8ceada07e404dec26fe196915da692764c529c013805506f99f08374c93979bbbb69beae8fe5f20bf90aeaaf24209944888259e5bd9b6ef1aec254c1c3573f0f772af610dd3788b3023934f1c551fd204518126f689be1b3e3e8454affd1f56cc5a60c0c6b576eadd7224a38b5cf8eefa3eded814b6269aa0c1f0ea73cedad693d055d0ff645ad4d6f796598a3d39d2fc57c7d70461352ee28abc2c244ca06efaceb345aadc4f35f76c07fb3712c44bc9b21f1440a99fd90dd1afa7c059aa18a7332bf698e0d73ffb02da143254926dfd4d42c3d6bff5fc4144b703d6212fedff730217e0235fbd4bcd0148e343e7864b7c0722a75863ec34e3b28603aaf2fe55a02027baed7b3c30ee61f531c9cedfa23a9ed4bc13223fe58047a8f030154c991168756f0992b99a87ed59aff92246551211ea06f1a6e8222ff6bac09ad6bfe3670c9117e3015a4784bddd517c41e308697940bcfc1b655086d6b70c484d659e2b40e814e29fde3817c32a19f87fe7a51c7242396aab0c40858b9eab2f5b6a5457a2471d1f2622be8ff82e0ea4dae9e642557cff31d1f63fcd95238144c888cabbe3d0e866ff4b1ab6071c4b9a230d651bc7c2d8864847bbe4a820839e05bc247199d0442325be81ac86d61cbc4d55c39d833ba264742c99813aab9e645bb43cbbad31ea728eb5b964b79d6e379165498c3d7cd7f7d51f2aa06804c3007e4f15400aca6f970e16f8fe4e7f844830cce87cacf50c25229624cf197a59e3879293e237602c8aa0be7ee9aff8e2090434f865a38b097d3b58c351d7c940992952d70e2fae9814978c8e7ec5bfcc8ee5ada4e68eefd389bc173f9e2da041b56cc04770f81e0b0ab83a17332b38b776ea749745122fc3c1ae3bb2fbce993e43f081191af80ea3cc1102b677ca96048ffad08c129602a98c6d2ba91e310b2c52c21ad31ca461bb8a53f7a9021691d7f4aedf03bea1b301c054905f39b17fe1db5779fba40d79ecd28c5e95193ebd56bddb3a3216c8639a67c064f7e0acd42cad2865a6283ff454476f825916b9696f4295b0d3ceb736b4727e390ad097604c5b2b08f078c4a53c4d5dddf8e0a294c65537efdd017f9cf7ce68a1370123eddb4399b1f9fbadb09de28d36b4c9d8f18f047144a1de06c174b9aabffc9a8e26fe62474014845a7165e1a4ff1958c2ea3fea2504c189d17ba481397e2665c9926823333b054e6d3c0aa0276f692d56b3862e34869b0e0ee75484d0e63f450f665a26b710aabdcf51e06bd4e557955ff66c3fd68bd9ec12f888544589595f2da67c51a69300222c0473077737ee693f6025ce91235f2a8082ff413f5afee0152ae498f36e512112c59880776a89fc2146fea269d311c4f14beb7cf18a84a317110c92648f7147cc83f5bb775f23e78d45d73f140d0d0a4024f09f897a0c5b3d89708897d8075f55bb78c8e2b7952ad7ebce39e97c7b134da82ddd4d5d048042c54e8834f205f413dcff67c7032c67df2ebfb4db0bc7ae8f277dfd39f8d7b139980afbd998cc484c83a60a0bed4dd50e137454e45eac95718d44e9d7e7174e810c096e372753789706895e78cf13e59ca0503ec73bc9415fcec5e4f14ff92c34c14c68d6f990bfdc4c29ac6e2d25785d1b4691e581277a0e9c027c2e49bfe6991ac3ec1bcff6350a67a7136a66a1f8201b4d42c6e176ee90ffe27e6e8f50b43e0c1e618adc77e208c9f789c79f96387eea293916aca89ef59fcc192702eee23cb321ce0a5408fb256465047770e886b36c32ba6dd79511ac746a2eb55e5ece63804e459748658e1bd71252bc7e4b374b8d05a9f2557b6d6544383c9e3b8d166f381b6162972cca2576ddce93eba5fd8b7b1372ce85618afae9136a2763ddcf9b9628fc3a3ad0f719226610c5cb69b95a5f46f39ab94a32d9d81eac69fec4d001adb48e0a8251e85a777513ef2114690a3555f9f24ac350f9ea38b6a1a493abd67c950b4d921d6946322e42082c527972c0adac577a3e492cef4499294460865b8b61af1e34a75d89cbde19bc2b9e4b73fcabd8097abc020bac9e6bdff2826793d3be98b4374844a78e11ed4c8cdad253e62a97e22d91e3f5751c282852c2e793622cf43f7dbecb6f516c394ab37545132df21af1f4514cae7f44971c21ba7273d3e2aed2ae3cf0c9a8e9183d06f77407b310074a6e544c724cb2da4dd4fb65f2665ca25a3cfd722335a6047734910526f9887e46361ace835ae6a7465d45f6676304c31962220d8dc1acc84c42fee726695510222b19c2c64449d7455146032f65c186f7f5d6460f0fe59fc67fad9f2ba4b748e3131abd61313511fefa988f5b7ba20b8da60e0220519caeee351588ba61d328253ae2dbbb8b4e37720ee30dfb7b5a53404eade09df696c0ac210b0ee9151c2f24a7b1a2214a911a299e372a6a44fbad30383c7d3b774da926a81ffc5d3fdc4a8978233dd5cb15b974f6b25ab71bdfb014acce9749eb8b9a983466e1378f8b959b502d61be645e370708ff83af6fad2f971556271922809fbea320fcf9eaac38ea9b9193f76a5e75cfeddcd4a2b3c614717e4cb4ff50e85b089bda141c8f3623603a7926deff799904da110325634b63f81bf2fb17970918a6997a3f654e41409e348c802307b583207b31b86e2c9a44947d64b2dca39d7594130eb22870a5a499b8c11156ea3ff07340438d611b3c3eb27ee5bfee689af144796081e3ae4ee34384136b49d03a1c6b20ba0f729a9cd2659ef0ae95a03f99f9e6acbd8419c154269f7f4719eeec09740ff23308b7a43fb2d40f44229ee80e0700b85c4d785c0344928fd9433dd18c433e9e0d509a6bf29d6046e661b753498c2d38cbcb193221c6580b8eab4e04cab74bcce967cf172cd2ef9db20c5ae3fb504f01534086a4c9bdb56f86c7ea7565326255af253ccbacef530d5a28c024d5ddebca8300395600325c5305582e32d5886f5e3971204c4b97a9b64586f6c04f5ac054c4fa55e521f1a70a8635c43e65aa4258e55c83fd0bea161d5ef0f704a0841bad6fc79cfee40fa32e2c7516bd3b89e0e6cbfbfd2d1b5892f3990956851a93d784fe635b5b471064baa2cb688a341a2d663f62be1622de981d3ddfca381bdee82c052904c50d9af768ac6e94be3f6d2230bd9c968bed8ca4fc5ec76a9d2f4694267bcd7a6b069c0620d6c4cc8280b6ae4662892ce304e76eacb28ff56bf39f15031ca4149b03f8399d07d79ff8f03374881fbb612ffbd34d2b8c88a0a5b559cf2aa21d24d5f01266fb3cb08d7491f316e7c458ea8b1a330ca9853355b2f6f5f398bdb9fbbe96a84cd2cd9518d8656bab29c6f7efe4cd5066db82735f577635a90e128c78ba0395ee379271c3781dff7427caa6f973c72a177a425cb2649271a299cc37d643244c565985e1595aad0d7cf5b3131b59855dc30a3d1d5b966a8df388ddbb71079bce1989fe1661a503caa89bf73a0edb0430ae3dac86dc715aae275d2a21963d9db20a2bf7abe8af6b155f95496acf6a1a16f143d23f55d4c04a0d70aeceeb87f140f969b941150be1ab22dfc483ac89998356606c0cf2a84d8700f60b52e966e943286408eb5721f7598bb8d4cb75191aa46cf9e7cd86f3587de6f4a64e58160023e1cf795d3fa52cba5c77422ebafb9b1f16c4543069e13234b7c575b894e08796e1a705d82fd69c0ef7ec3223fdcdf7fc37ee336402596d5adc1fd83d5bb030f7302b56d274c4d4691a8b1020b7f8d7769a6a48ec05d889036157891e5f73de92a51a381ef1d753f03ba30db21216a62c4624a142e6874252752ccbbcb069ed45bc2ca3e09380baa4eed0a9b3e6de4d84fc65e6392c448245e98edac41515020de1211786038cadc4121eea5a0c182c227a8fba8424f308b11626bd50f3748e4124b0ca47b1bcc92f91edadc33b5654fc4c6291dd3c0405268a88aac0e4615236e6f325c3f2dfa3caa9aed08ace727116e0823d2a665bfef9f43b7434e0878c08d89faaa84cc676c635c4c6932ebf8a6ba422ef47aec2f43631d6298c881c87f38670b20adbc1df9829d40f717456852bfcf49797191e4eaff60725878fa08bc84ab84af3779c5d2b4d0159d99bc2d6660ae2cd6e8ccde6614c85cf8ec555f136464b7a4acefa976307258b334c8396dfe8b7a155e20616236e5665e53d900ad90b405d1c3f44fa1af6ff05c713f0acd74cbfc30510c53e676c44e3de4c2d44ee98423b64a3f4e2c992b0b13be11d614b1a6458c32999058b4994dc784ba2167340ead87af6131568f542896e3a6866617196f805bd978527e84a0fa72364438728dc4d8105ae863860d1f1a72fd12fc7f435f0b962e87af1c94bcaef9b5264c5a61f5812e8620d9bc3d564e19917b5ee4e37e8568c9ccff222c0652fada836e006fb81f0b2d9335ef207e104dde7fd3bc8326c41816d635750c73aa2f336feaaae389e02bb1d45352d39e68a4fdc9cd5fcff71bc8e4fa5ca98aebdaa9849b2ca84b4db3abfebd69b9a3fa6533f6056785d48cd6bb94fd13f6cfbd6694fa7ece635415d5c7d5340deab23cb24d5ac3420c00fa4917b6935bb93884fb25102d2d2937c7ee33fbea694ef710b100713a285bd9adb1f963608b5f1c635bf05df0b045316e0185b0f00ae9456ad1171fbf9b7603383e055d6174d386728d2b4e651ebbe9cdb520343c40f427f8ab249a038d33cf20665431976f668248b3dad69b08f631e731f7811fc85957b7585bcd063bb1a3b819771eed1b1f436bfa309090ad9062c41c9e763ce7a6c8ebda666ff03239c4ca55baaccaa0cc85632c0a6b27e8939f5b6ce0c111fce8abd5249adca33a132be3c28ccce2f43c8ba3747226606c42b05329c37321193611a7d717a0ba1796b4b2e94b37e023707a8d1beeec0fefa36780e20a0b8119cdfb55ec27088d72ac3cc876b7baa6f49280dfe1a0d795c535c75b00b6f60566a612d76497e197043a7a35412ed1b90839cd758eb82ee60732356b6450582150911c2ab938890f157e95bde9e55cdd78eb2e05dff653a25dd722a68de93609c6da6aea8b6d6dae4a0afce53a09f16cde6ab330cecef947004bc053341fde817a92de9469e35d88ed1282aa8b9ad55dad23df4f6af1fc2373dc09e76f8fd340f77384ca0e2b6e5a7ac44b1784a4bf5c1ca45fa5b5755a5e2e50eb1579a2de0cc83a38f9c7d4541728a100dcbf711ae7e0234674cdc5e34af977bbbfd51b9a11d0a463315662e615016de61a246ad9d8ca9eb00f4d0ff943affe6b9906c7b2901cfa1a2daf6f58fccb222b4073528391a46cddf1eb6176c236dc875c8e3efb958965c96e274bab670df1988519d0847a1fb9962ff6ef929657c617db7a1569583f74229e38c7d4a9fb99b3b1ddcd0caf0252fda2e53f1ec5687a2e9d5bb4aed1274b71996f7265960f7c6d9994d916b8698fed3f6c26c1e92b37577fff86e26d93c6fbe5c5efaaaf1aecd1a94ced8b7b5fde899205805fdf98152682dc5a43b43e0f6d5474051594b8ba4737b7998d783d2c72f1dd40449589d2084c09888796e0ac0f7983c43eaa9b599b8f487b6be3fd7feb291f17c19402eab89b77552049ec33dd0291b37e82a22ecf75ff87613a5e527e8c9e0621b83282c0dd2a8a460b25850aa05cb8405fd02986e968e5a5e8a235c7ebf6f8809f0d34d5d6e3c06cc602ef4daff2c90f62ba4c37ce129265064afd617ae77df77445c3097eeb0e9ceb33dbc44a7ccb69a68227e66e41a8d47b62fad21bd2d81e3a95c76fc0b3cc1e6fef74bbb1f1091597275009574bf3036a4a9f0a3dc219fc8c39269b3c513feb6b49fd3d7a4de6fd27dfda807090e0f80399d0a7087967ea69bb6306dc756f9c62af7bce92a073549eff6be3047256e1571d581484c8891a969df90da6a8d4614abc69ee53ddc8ed57c8c785d5a52800bfcacd3a6580e57f3951666d5127402b1c2435a7779fa63c364bb1cd720b98b61841cb797210a9c6574a852f9b72ad31a13db8bcdc13439c68d2e5d818bfe25f4d8fa26b0104966fa740d6bbe598f26d2968137272f5074befec1ab9bf41d05d8618a3acbe5aa6f265df371c8dc579011e962448b1b9fa9070f2d459b1315a4ccdc342199e99c2cafb9da481f93a92bc7b348a9ba7b2145f49209106931e740e10faeee6970d21fd3bc66044ab6209eaea2f67b9b70bb574016a36b83f589d7cb609a1357442547f2426162f8bd4539a785d4af635bb65df2f6e951debdab3e12272d6e48a515c92453c01a2cc814898a9a10b7d05092522dd23db6b8a89e7d851e93eeead1b64c7037ccc09be77b837bb05bf2e941659882704a5a3311e1e4c99753dbdda4b06bbb3c8dd1ca00b8e3da0f14274106371d027a14db1f39fd072a4d944a9b156c69b70059ea963f39104676d001241b42c69a46182bf05ba263484a327e45b3ec43ecb06fd1834c5cd8f719e783ebe8daf3e610bf43d3351fbb6aa0b401af3d1742a1613427a7a9b415e52f5c1be619f219cde862b367b7a6714f114025fa76b9d86c2c5fadbe94861b0b0c8f6e775ac40cdce02b11f7baa30d6352c502e2d8e00c6942075090aeedf281f1e0aaaebd82cc06579374bfe86b85e13c498334f6f632a258e2ed50f0a373f7b8755e4b53ad2add609db2f09982f5b0fe46a67de694ddc482fe67c59be0eb23a42c1cd9875dd031db5ff9c037592ad5fec00df76b4db92e44a818dfea5f767bab5b1522ca9935f82c94629aef68c25b617016edcb3289d39fa5fad4008bdafa8ec53846954af482cc0c4e21ff79eba9ddbc76e2e935a31729864768f6543c0906524db48d23360e131519a3505cc91d87d89a5203e57dc1e8c5ea5a739372b6c8dace999b17acc03698adca6bf3ca3dcb0c964bdee9e5466f3e6a46efbba5497eefff89028132dfbaf01da296fec4f8dfdda964c6b52ec1b7b9fa74d02a143047ccf3f46c03674bd4261ac1c1bc8fe7058955ee6f9803f2cab0401ec7eacfee27d5d20c0ecca7acc122a39884759ede5125fa627add8d2a76614d141905feebe8bb4d4c9eadc473fd242e3a3b6b387d7ceba3f3930902d3f05a9a6d62f6e0f93b509256c03e05e2b5ddaa5694db93a106a7ba9dce311d40448eaa0a3412cb1c3ba6f5139e6aead6871bbb9eb2c33ffe78421feb425e141dfadfac5775810bd1dc6e66f93b03e087307a029bc64fa277ebfaf6b660b6ac7e7c5e165751760d903470ca75a2524fe8defacad4beef98c30fd22a451df5d864e44716100b68d176d237fdc0428d287f80141d70cf6bed71359d9ee7a8fa5adf0d2935c46d1c196e3ca71bbb505b59f364400fa205fad48b8a7fde7649e9e69bcf648a766b156886b12ed8fcb3fc366133d0d7c8c06bbe4a266eca87d1c35ffdc3567f9d563f25ea8ac96404346df195324c67b02fd363cb5659200242725c0bbf363242b7701b604552f357026e522e851777647a0948a67c5f298eb208e459a338016076ee4f75d5f427db1ea97c84e92f9a2a66e3f6467039a3d7c801093e3c17deb7e3c760b2bd48b3ab7a60adeaf93c206a34125b9c3ef1ccccff571805efb540b9dbc7e23a41a6f634ca469dfc3243b10113edc756ee5e0d1ba9e6e34bd4c8853b7c4c6e5f7db69d8d66d8a3f5d911ea311b4b538fd48817aa7281f41f5208ef867a57d5a9eadfbab888a419c9fd27110c9d54433a8fbc9585fa1e4250c67d237254ba2ceea9ee8ccecc9a67a6a13c2096b4d729b4f1310115f1fc64f481fbbb73b232e7548256075b79ff03cb7225f6fa16cb148340ef8f483d7a1517b7ff5a5318b3f953ec4ddb744062338147895624ad72a1038ddbcc71eba299c8d6ccc8929513b24918b5e6c51f5cc27b76c9ccd375f4d504ff9846e2e03f4ae84846be17ea42639702c41e85772cd05113211a9a200bcf34da59f7dbdbffd8c66373982da9e1436e8f9c63f8e498c2b58dfef77ca2756bf795348f63f9f7c1c8b681f554f41da88181a9745ab291b8a25f0aa2cb7ee40efb4e5eb802df9b4e24509c75be717a10b45fa4404c6fe7b31d23aaebbbda44dcc2cc3928b620aabcc4f771dc7947b55f74d886e8b39634bcd4e8ec552a46313afd6ee405c97816a7d7c7e7f0ac141772a65b9b1525ee684570e8bfb3520d3d94fd1af6c8efd207b5db0529a0592319cc68eb27b205ae548fb895aea8333c74cbb2c98e89351613f3c01b6a8882f0e91b6e20030c084da44d688e276f394ef3bff6164b48187df781c199237d436241c6b462a90c357acbbe170b9dcb1a277cb7115eaa85b0f5dd183be28d41c0b4deecd24a94a56328f83b388b13b87d0f3788ba95052994651dc15ff7a853388d3ae5b3409024a1d46122067a4afd086ab499186ae93008f43690afc7be1faaa12a3f60f58f89edba6396f058ac5de05394f36219d29dae85ae57eb8a8275320dfd2cae7c45ef52b485d78f9f34fb29fde8c234536b91ac86922743915fdff4b6c7d9f87ce14896519051a252319e2d65a73f8bdabb1b14c694c1965ec3b4ea26d36eaa7a0c0fa0a8b7809a31cd2f211ba2bc3aa7fef2c9577f3ed493267f9e68020ef17b0ab82d42cc6695af7d2e06ed798af93551ecaba06fb86aedc2e7cd2dfefa6d301ecd8e114024db0d00ee0244e7d71009cda6edda072c0c84ce99501a3bdfdd0af1d069ce38bef69f91565869e9f96236fe6f3a0c052d942f3a92b0d6dc3684276b5cb93ff56b65ebceabed3aeefb7fc76af1daa894845a088fcc8c466f3342bf6ca2c759fe13a43d0e5e0f4ad6f8ff91121073124faaf72bb903fa95d393b14f9c3ffba2e1d991a9d5884d61783fde89e903a1ec28e343184f48ca4e01e4e6a3a60b7a7e63394a6effd426ee4ce6d9f4cffbdee0dc7c8cac7fe4d3a151";
		String expectedSig3 = "00000002e562f6fc4309848d94edc37e66c4fa704a494576668583b3325e859eb7c67c9f74ad76223a4a61b8f9d6bf9f9d64b74b6a8f41f64ceb5c9166787bec71f1c551a89b81d779fd0b895b601d94fb090e4a16763872e3d4f49032f518cccc926c6fff920ca8a9ade8519de4e437150a204e4d1badcb798d72f36c7c479807a867c092563ed444db47044587d0fe1390af103903737173fed76757ec41edf48a6687cfe95f1ea6cb8cbbbfe97c7bccdf8d7ff610e8bced78ee6d9d4655a897cd6135b530400344cc07f1872b7b5cf4c3732834f99b85c876c20afb14ce4992aa736a0cf342ff8d2788a2b9b2854ab87aa164721f46efd8466de020ec298823b24086952088b5b0f390cd253fcc0fc7167fdab1b47fe498ac13341594a815c89cc56a7e157be26cf2f43025eae654a7fce2b04e03f53ecfb06a3ce881d447bf78ad9d5838b02deb85177ea2d530f0d227944b1a2b70abb853295856c9a1e46d613af05c736808b794341900dbb71d9d762fcf146c3477383b9de4fb1f576dacc5ed0c27bfbb5c2699f4bbebb5c7ecebed071e15f967d179849bef7706ab4b1b8445e2dbc0dcaf81b550540e11c871eb81ffad3dd21d806eaf1b0ba5abfba5339f4ba7379aa82c6496524b1c2f8a795d475d023528bcfa917e782e230173df64f43db7f3e43c4984fab42d34d27eb0a3b9dfd1b9aa51ed986fe7be15fecc4bf04ae3b5087e282c7dacf0d0de3822ad558d12b3ba44774300235edbf2b3732b7ec1b199f34bee17ddbcde80aae09b2af0ccf48fee5d63f60c0e13f6576469e1da9d88a0cb04eb9820953ca33447e25e590e9e864df0e8283e6c3ca8b1d99b40b12efe401c37831833e7e0c0df333a821c455aa5e6725e55556ccaddc7b5a32c9de7f06815dff6dfc3f6abcb5a418138567ae33f950e4dbda13053832b6db143525b4440efef9df8f5c7bcdde4c977f6320aa8e6bcafc554c77389e13a5c54dd5b8030136a16ab446b0453e4dbb351cca0b4fd0a87e2577920f55bf9653a9ac500778b8aeea184d0fd5dbcf8185c0885b01b4e1541a82b871e9931636d9ec7790e41c866c0bcfd61e717d8e9540c81b8c49397e3ffe156e2ae1df5ef8df1037b38bac72653b7a0a4f233752f818ca13cb229edf627cf07580fb1df85f7166c33460917c244d96d8d31c04e9460efb99e04cecb602023e1b1809a49912bb5777f1a77ca4887c5f1eefb73f9e8c094effe828180ba4d15dfac79ba02caa1868240e4d38c3ff3486e8f57de56f6cd021074442d5dde13272277ff25a891eef04b3c7a46151dacdd7614250a135b136177150331ae5bd71214a809705f12de9485107330da502bfb32a36566e13d32c43ac002e57e8ad90e37220c8a2ca7040dc1521099c37a7968606f815aaa84631ef226de57b358994d65cf9465ad6b26943ccaf1063a1013e5d08e6c421f6307bcd08ed279cb1bccf60726ed141ab3a8d0fa5d90145c5bcb6796d89e74c931b41a8ab705ea7577c571b9e78fc11be2138d93d7ac37f115151b9b4ee3e32cc11be4e2c12d1e83c49393e5413911e02195f6301cf9ac6a62f6553d0f1027ccf26d14f102bbca64c7521b076c559ad0b9c7a5a32763fe9d3dbd06711615fda0a0d9e89b37ef4afd08c9e35592a88f2e053df585d660a10c4c68325c3005c66d03562374a70500b5da12b6605ec3bf1f0f3a80da582a6ffbd7216ef25158928d114758e0642481bc7efa4b6f7cfa8925d2caf58653fb3248494fac480b6e7c0066d213902e2c60ec5f77c4b54198d9139e496938ccaa3a4e1889b1742f368bf8c147fdda52fdcb857914dede1255cd2912450819387b860e500e3c3bfb479cf9ad511a1cee610c9518b193b49061465c453c25613c786cbd8da5cc094ba6f553401379b575f62d94d4bba2c2fc50536064287a3a9fc5fada562ef397786d057b9a86b58e67cde301107dc7521819c9cbed13841df19630adad4bce9a5aeb75261bab1afe9bd3d02aa2fcdeede6e286aee8bbaf241c5da8bced0c2fc121a27d48a50644ad379fcd883d8636654ad8263eae3fefd9c078f9103be57248b7fc91e055c8f5cc66c65201978e08fadeaed66b37433b3e947c169c63b65524192c726f42cd66360e254bb5f36a0196379464272813c28cf3bc0a9eb95ffdc74ba56454ae82d4e4591a782a14a85e79ab1fa6fb25960002c4486ea48105b332c9eaa6fe39326da9af65491c46fc1af18276f8377e3b386c91a546574ca807765b4f4b6eb7d8fcd181879ed79ea92d85348664c3e12346064211a9af13cdbc2c0f4786c77ac492b3b4175a66556f9e0a3e9b176aed98cecda4140c15e4651e37e8c1e9f471079ae1b69576845e75130a907dd47d004be9ec37d28d5a12e68d5a19abd11922e7a7010c3dafe35c046ab29534ec1132b9578264cd0afcf169ba52644f27fa76abda43013390a04a94387daef190e10a61d312c01cf5f8ae2d732f7ce8ab8318546037c648777f1fafc91f29648ac3ff42fce611def0ea6696bcd17f66cf667b42e89dc794191da67a0ff4ce9457f0b7e66f599f4e8c7f72e86d5048a79d455d518dd5df65e7bbea3ae93519d9a4fdc326f0adbc1a59c60cf306bbb17b8df0ef9e4a63c3019cd0cb76f49429f54db5d73295ef07da93a627f6405a58b6329bb45e0f2adba9e4e0370f69214a26c69640d13e28cac9f6b9133da59f2f8478b39a8a682521ff3591738127f04f3a5922d32e49a375440f6dfa7c981a23ee0a2bde309d6cb172e74fb8c97c58f2eb70cf3eb943dd1d65492f1cecd7223d2e38dd1744238bdfc0a4b1bfadbe61af5a73d5bfd5a8dd96e4f61b071ec943e149fc3e99cab4cd69bb89b9b9d6790102f7c8ec55a5ffcc0afcf48b8241e1975e6b598cda1773dccd4f7ada514ae3309787112283b32eb9e23defe638256af4f3d238a2d6419687ba889d555a2e708a89e04d3fc759a924aecb28f5e9a58b9a2cbd20547edb00f47dfacf3262690b98797dc82f4216f43440404f5920ec84cc7702325043f3c3f8e3720446aae49028ee6b5b25f8fdebf1f944e111a77477e62aabcd79bcf404576ec63306b3c99cf99d11b6d0e3fe6b8f69c3a05d7cf37498da295b86858fa3f8d984d86f821cd3578069f9692a79750be2497d9ee31f9100031aa0ac185314b7650541071e064264fd4c01887c667b19342e59e2c1a27c03ebe4713a2deb57f6120961c167eab95e5db56e64c38ea823037887a38c431d19528589e2e714a0b3b38abd8046657676b39807823a81059370c57328aa1bb99d65d890f72c9d2d85f2a7daa4ca291120b3a531ec204e403684434e0018d0de25e97109b759a94157772c684da723000a1b3a6a22b686e06b1b6e8478ebf1987fb2aceb0a3e628789fb387886a2294ad81b56543e3efe37374c08886ded6c254950ee5713da4c65bbdca876b93501c0558e1b4d6ebcfe58c3ec2b0bbf3834c10aa309709f3d70cb6727224ec7f81dd8fc94b15718c2f936a0e0a09189549c9ecfe794c972b4a68c7bde7db5b548476437decd31122c642fd13482f7a7bed49e42ca25ba05503b1adfdcb820c065c2fab4668d4e3a8e38ce2ea04ec3816b6f51468b9fcc4e3aeb9e9bfed8099a33a58aa663eeca42e94eb016fce9bf4cb4b554048943550bf719f6477b20e873c9174c0f846b199973e8a0b9e295039bc16ce498a840c43b12d948d210efc8fdb099cdd2d5403e6f1bde8f7c9532420d4645171e8e76b949efd7ec81eff5a4fb344d832fe2c1b1aafea1e374bddd55be1e5ea3650b4bb48c0e536c5efd88efa9a8425a4749c0862697e336b5ade95e054ac3f4e865e9fccdb6f560c8e016dad4d05cdcfb1d3bb8b34455a46ac2f131d2d6d2dbfae83e4fb4364d090c940e3a8dea60f6b9f7c7e6ba5f555ca840d3d7755919ade128aa15ff8fba796e58a6f852cbe7c95818365596875ea3260cdb23f098728cfe5c10b2bc8a251561367df1c356306591fed43ee205d5d93260edac6969e9525fbd27777cb3ebb60fbbb92cc974c2cf980c066d8d7bb8b1a6c403c13798fd38e877dd3ed6afafc703915e9b7fa3ddb3cf52e19d934d10e698cfe2fff09aac97ef97916ebb22ed61ca21f4c89c5e14935b0986b8d7bc97e077b88609b4b7b3fe73a29c72b0f9ee568c299f19d6925e90b06a5a52cb0ccfbe9f63d1314437965a63588f8df1af5c81c76f564ebc03a34b77a1eefc5857db0060b529e3dc758d891d5597c69973983211c80cae2177bcd3b0f8e34022fd3639a83404f4beeebf411c4f57e1cfd8670178f809b7b47cd7cd51addc8aac747799ccaadcbacd6f0b49be76a3a05e659eb4a16c96148b64b8400b9ad64b3f1b80d6d668fc908a31181efc86e5cb3bd7cf0d31299fe5aaa78cbc6575dafe64a207a3fb97600d4f01997dcd401e37955de356c32d87484293a6abb312c4fa21649e6cbeb4f1082fa8de1f8a35eadf4b131ef2e11ff143ce4a30296ab548e1e31b60401f805c932bd88dc966953ab129725db04ceaa5624b9d21ebe014f04c025d96902564b1d680c33dd832c2b98f4a0d57d23ad1f1aa86920927d8f8fb1d5418d7b8e35ec596329985d2954dd37a3d067442a42d2341bf7af21c004f700205fb3286e5a141193c79260918c2b5938b578cc1ca8f230184ea3c10016633836a19f01874f7a2899fda1ab82c70a5899bc8f532893168f07f918d87150ea2ded8324fb7818c4783a7365f31bec8959116248936179d8d9f064b559e77b172d480645f07f12cfcb4e734d9a7c4d29fa67a4953a3b81283f9778baee42e43af6d62b6923b3c93334e55adb25ada7d03a14d268dfa203e0ab2d4f011244e89625c2f39d1a17a1b5ee38a58855565532deef41dc784888833c43ffaa78d17d032cc784ddc583997f6cfaf91bdb675b2faf434bd7eb67c6040668d11f3fbde06e8a000b3b5aa7b76c29a840253364d8061225e942f7851aec73635fd187cb81e68b5182c1b6de1e2b410830bd7606ecab1c460e647b7085f9d87e4f7bfef55d80e03206e64dfbba7b37fb406cf7c515b819c3232be46a54016396c962b244c72fcef53830b93783b39f247d5a664174f5e405985f42375aff61934e175d6f2f498e38db514efcc746a63ec346a785eb1553bf6135beb2c321917446f85addf6f2e1fdf1d85ee4506d4d1e8e9ee51dc9a735a2ca822a9d5c6036464451447bc0ae4fa797c4f0dfb1cbcd98c478955dcbb902b781c6e3fe9d6c8550a436f28fdce6e898da349546b67bc4a44effb31706d828ea06654102a43cd5ed97e2863c22dbfd723ad0a8d3c41402556a930c5645a726eb57f180ca17d586245be1b75e0898b7c83c457563c5705dcaafb5eade289fd6230290cc1c8e8b79335422dc8e6333b82f5a06345b06370eb4c46315cf511423b55a0bda564d441fb2b4c56846148978e38997b6513d7e8cf0857e01919fa3cba52f3bac442f1e6618bb69e6354dbc706371e221b11081f397aca6941d0d0467126fe573aeff20d7f6c87d75f050b4450240f62b73d88209842479419c5426407dccadc1542c56a2d1b0a7ecaa2ff8097bb70c80b8f1ac03c132c622768c59ad34c3eabeb14fc979f492883f563f57d3071708065fdf1e1caa85bc6603b1f963f77d62ef4beb1ce8f089c679c26d9e8ad4ec2f092db8572b0a13cb119f7d9595dada1d7a5b22ae3986c99b0217a24f62a61f4a83197e2bafbd4477401193a4036674eb67df244aaba8b601f29b33f36a4adc971785e579a3af43db08633605587cd65059a87682a6b41b6a78d1acc3c7b8e1e814444edbfae841bf65a8a4d4d99d7150cb158e620803509eaccb286bd8b8c41511e5bfdb36471657ec3af0d41764a0390e00974ed00ab292dc2fd7585e77b2d19620a26923d2caae04946fc52d5727aa2a9e7192303a74fd5a4cbcbee3b984b37f90ecb9a85afeb60b3cf3905f68e48607e0c2e21d015f0c27f44cbf4a77fe8758ce076eaae8789f64058883a0cd3c645ab13e179604dd7d9dd3f2b569c98dc9e9bc65c69cd179a1a8f456295e46f8ea1b09b543b6bc8754145bc54d70e0960c8f764f2541c8b77b923eb592f5bc5fd0c1e830d544990d41339e4d1dca02a8dfb444c73385e65217bb51e5c8a20395f17aa437567093cc79d247449344e88f1553ab8af5f18e1b6f1bdc4189420d1460482f5c2af950b56ee412017e78ddaa54f43ccaa61daf2a8cd9b86afca19b764b4197d636741d37dec4bf19d19e92196bb2af15315522c60927e9a779d5cb48d8fba18e925e5417a38a0f0fcb96324d3d3aa6cdb81cb13ea48019e8d91e049f3e810bae70c29e07d0a8c081c15174b6c916af5265733beb4e3a999ba2565f6340c14bbc66982e38c56a0749653bfa4326cb477415680fb768bd67d146484e4bfa64554d907c46a5f988dfa0d2964541e48260cd4a560c8ab323ba8e81a0ffe5d3001fa0702fd1e6de01e12b97d1f23c1550e71c89d7e0f928a9b25dc149267d318474ed92f036e9b63bf342437d24bc905084ac4815ef02588699470448557d5cbd1cabb744c051eafc7e240b84c78fdf18e9bf02b5d53430d2fb609c984825023442af25b25eb035cc52ae87adb52e1a9ba1ab79e1c7d55905f5074d8973a7374b87da04f3112bf20711493f1d922ba8181b89c262c5104de2b32ecbadd4765fe1733f362971a3e8ff1fce5bc9b37d7958a3949e587a1f52393102d686887a124bf19c3940a7843fe93a5744602a71fa3850154acef1be6ff8d1c9ad6a4a4490daada69a22942b9275fe4edb91e561f796d95cea975e82b62f766100e0ba67ce8a45dd21bbb025c9063969432fa54849f262fb15cc202f90b06db1a8dd470d859bcf5418521f336b3daeec2da14a2b6db4da5fd4d8a2ed987cd2196bf74ced7cb478ca144732f54abb89d6034f69a90dd69f3f5630cf459499723dce8d482fc6b51c06d8a539952dab616642e59cf77abf33bf6b20883110e83f0059c80a2963a7421b10dfd0c522a6b6e7dfbc92fe2d05c636cb11f6764d3d0a7adc3abad14be37a6db65831b2a6179b71e838ef2c36b4bc9e55a87f5b055068e5a31734ac764a026beb0fea0010a6ab7091bd22d5e4c424e7aee53179bda9f311b15a5e90032e5043b44f07aaca84b9d889e18273cdeb71eccf9185c2bb21185991a8cb4efd5fee7fa414f52c12969707efa65c054d0e88df6b08dbbe60922d2ab599016eb85ed8d4f09b2de5583ab4d82c37cba886b29f10d0944101a0862152e3463027db9a8911a399e206e2336f4d0870c2d6d448eb7ffbdfc45f5bbdbf985a427d0773380beb515b1f4d09c131cc53da2337124b67fa306f15da9ab2a181c76893ec782697d46946fa4c32b10cb9458661d2edf8e15a12274e55de846b44a1205976cc6bf5b4e7350d907e1c1ce20f0bff1ddb28e3675fa3f6b9a1788031a0243643bf7602e10c837423e2509f9cf634622eeb0cc2dd1995e8ed04646c4056b94bb781d20e846f660faf0230a2e9120a488312e93d211d3e12f2ddab97bd3dec3d1dbe132af18ff4dce52b879bae3a500924c51a9e5973efdba9b109f033fc2ea2079884ba6a12066c4eb5124d24d8524407e86daf090b72ef114e6c5bca339653b26e63779aa81d688b0aceae8388add38b5c9235d9f05d7d6deb733d2f11a7fc54ae60a49fa4f91f308430ceca3bfe146b980ab76733f5be61013f0f889fe563e3ea4ee795cf5816146d695dc117e97c0a2c254d635f67d862b01d6ee73f00bce4d8c753903dfb3cd29a0a77d12263c3581a084706f9ec71ddb041993f7c806c92e71c8cf7ba46dd2d468fad1a80c872c707f781c2fec8cf5b396b326244fa65afa6d30725216ad4b8033dfbe00e2047bcc422f99427deb8d9c9c85e294ab04e26267ea48ba3bfb78cc2819070d17a6f217addc953c764f9a5d837a76b6ac2f435d65f70816c8207a56a40308ef87c3061fcdf7b404cb7e617cbb210fe3483582036c907646ccc75166862dbd91d80a6e8722d57cbc4235bcb4492a78b9e67cb8880f94734ca2675de371e44c6883de9616ebb9919f580163c12ef904c5982b0877ca11010ffc26ca2059041e853462fad98a5234e0964c68245111d8752c59ca930ac0394c8c877404a5cbef826f91bbdb2abc12c8c9a6f287aa66f8f5b642da944096662e2f3a3c9c82e746ca84f4f67d80713e59e8f490d7bf6138f41f6b5fab468acaf7d58e6d39ed3f7ae063856aa70098c811259efbbd75eba9001cc0aedb8f13aabb37ab2fb3a39ea0359e2cb049a714a1329a7968b36c8696bf2cd9e866068196c4d4ab773897fd973e3200461a6c255260403bcba5c441ffa6712252c566adf1de6636014da123993c37853b8625fd1ef9ee49c9f156538f13b76efe0780844a1686842605c30636be702f41fbdfd64fc8cef6bb777ecb6ca30222fdca0b6346e88a94e9b7c3c90aaf40ebda6a27351fbea789653220a2a22e85f11f0cefc336e0761daae2eb04313d86579432feef3a6144665144a8f1c775bccdee1cd11325f26c7f1db757aadf4fc2342cc9155d206db4a012031ebad37df2f5cfdda965b3b0a5b80d79e1a1013ee0d744227eec5a327da5ad4f335f849e0fcb9b3cf05b7c08b491530bc213671a541b7d12cd85a87df34d776187bb3f3aa4a0534abfd3151fe7cfab3e73f4c6cbb882374117555bcb8dbd51b3726ee19705384781e270d311cef9ef937dccfc9ea4191eb0b104dc8e7629e17bc00bbddb151b733ca88bc6d9ae7036ef8d2029d13b8940b8b38589c23fd5dccff9f215fb5ac05b4de83276b4c5f89994c923b743c5c9e635704a3ba2ff59b4e02f057264c80475dd36f39badc1826cde0f889066625aa1f64ff8c7964a9396bb6b49d5baf31d596578ae331705cbd8781deee04a9c07468abb49918e1ea3ee29a5207aa7a40d018255d8a66dfedeb56fa02fbf3e0aaa7253cfcdc1fdc29edc55b209da83805d26216e10ce7347f7f17f2c826448eba6e92fc49375601e1aa3b9599bc3db576398cfd2d35c511fd3521c29ee8361b8f1cb49b8d89a93e6491572df130cff0bbfb31f551686e458965f2e8d9e9a787688acd5e671af4a580f6bf2750200ae7543cfeaff6c4caee104200d82f82d4849b1925a21ae898f4af5e0aba8c6fbcc1b25c29ae30bc23981022087bb5f8ef406cc6d196f72b3a5971909121b738cc0cad900c107465ac3418f5a674963f7143a945b7f31ae5e4786a49f2afa8edd63332b3a85a0a5813624b5f8410513742d50a5ab3d329146f116c057c7a96b4cf9044c943e71d8456c96fcc7401f66dd471ac380f07261da888c104ef74b5b593dc45dbc4403d01161753145095c806a6c21e7660d52d027843f57e7657d43c13b62e7f646ee7421f79d14e75f33591e3fa8eaa9c657db6bda4597d3e5abfa7d13939b8b7ee565d82d48f8e4fb9f08d33cd7ac1be09f23dd647b5b57eeac2d90059efbaffacc8414cc76135a1765e5eaf5f28ced176c2369ee4f472229c4cca3ef23266ab74ba59415a006f5760c32bd05ce8a8644eb794ca71e6b96051784313e9dde1c6b9fddc150ca9db3b81da4af0d842ed7fe08b71beb31f05844b584e00590cff7e4c66ff1de4244cc64d7b7ec99d2f15a046e63bc06f3307da4d7c32d502ba8ab09569d7e31eca4b9362f93ca195e767f9e65c52cb7a056feab014b09a968cc88bc7dba844d264487a59351827fd4a3320779da2c772e45c7b5c249e1d212512589d867cbcedc0a49c127f853910254de6eb00975d1e4a8a2d27d41967b374aadf53c8c7ccd3b2f109eace51623ec5494c84ae0ed243bfc4e6610521c063d7fb107429773a642cdd27f41b80cf0262ff6e75c1a5a241a9dcbe2194eb98ee9db2c6ec11805a432cd6ccc85a2be68cb506617793635957568e9bceddd5bd694195aae86707d090be834e2e30cf4c16982291ff287862bd2edb19916f78a8987dd626766cccf7c44a6573326490aa1e47c8c7d9ae24f9976693dfb2795d035ea46edb61073616cb24e142c0278e01a94fe25344f39b971b336e7b57607be1dde08d6fe7c7c7d58ace7bbe2739a66181a430581babfe7dc09d96c16e790e55b059a7c877194f14c8b00eb858ddc2a77d93a2c15834568c3dfb15323bbb1243b82143884be622727f045ff8c2ea44d0ab33531c893c3a85863504effaebc8aa34dd8ac38c56a4865a3d9b2fd15467a3309fbc52774e2b1c99313dd9713dccebb9cb981f2ae12a8d486f29364de00c2d7279f6ffe9e2ff77719d2610b5f552b13ae769941960822eead03da1a8e16fe44e595b062afa6944786700a8d16c62ddd59ab928e2dcff3656e3092047746ab9674a4e6438e46fe3ab0d5e9c668a347066f7a006239f86fa5ef7273c429f365f245bbc35d0d2e4757a78f9edc9632e4fa98a00b3a4e116185fbaa5d48d65309d061a72df633f6e6980ee40aa5c8f304c89f9793ab81f14dd613b40bb70e30f4cf5a39b39ae41ee9ca856b26f1e27eec60a23d3ca3290feffad0e2fd90c65f203f14e556f6480a85b43abb9627baa802a8a90f8f47bac2aa8e4e56200fb24f2809e01d5b233c9064c75ddbac731e170d9958e4dde27c6b873c6d6d3a043918dc4cfc76ba472049d20a099e91e32d955308a03a0a1b6c8208319537371c0913ad7bbd6c6afc91a7484ade39ddf885283b92ff0c4c8cd5b2649f25f033006dd31a5bd1dd10321534189a0675c06741710263b04a2ee2a2ea9ac3242f2884edc4e46c55bb760aa5497179fff146c81a2628570480bbdeb82d2da260fa365c17e6dc498353fd378e3caf4fb40e4ee961df480fe7d458edd4de37edde4229301734a0fa85cc26cc914343abf2d6ef296a57a732374e46c2712dee8cd962fa08c1f1cbf0f9dd8c41338d3032a95dcf49cc8ad0c161d4090b0a186df49d4fc1a105e21f4121eb873d301ceeab929870b5a41a68beca6ece8b53e26d56b744f4e1b1b8f2ebf65b054d2cfbd5026948479aa47af4081ee647eaa776a48a101a6e5ffde456102311aaf2bc2328e5b5ef4e5afef0addcf4a40319754a36524b5ad0fa1cfefead732b30e5dd8ffb302f565d4ef4be456ec680c0dce8e3cbbbd459523cf5d140262c6d92b6a0dafb9217a3ec04e37e1298fe05102be527595ef8b8fc439896a20b6474da0a2d98af06c761b506a43b4f5e6d7aadcc2f22d12b3d60879abb042a00650cc844455a9cc97e3b540dbbaeab486287b6c2c4c0cf8f204c89025252177cf304808aa9d49b5981efcee9a359a1885cfbe44eeb9e165c0d94f851d98cb0f916aba14515d4444b743b5b102bd10da2b649c18bf8ab3052296c12a520ea370443b9192e54001056c391a2ebdac32ad025ec3ce6d1a5116c03b1879d64b235c8e57f00fb7e1c201c27da7e85b5afa8f9b6b799207f8a1326193601802298850c4db3d9c20add5c5ce71b6fb6e30d355040408fcc8e462e2040bec135ea693c92586856917523b21ce01eb8a21055ec14b214a87d2fbc7a500fe09e3168b05e3a2c5b734a9d9bf5482ccfb8765717ab08020c6f9de05a0f43ec7d6a298e4a34292b099cfe042a4c3c3c5c5e1337bde01fe50f6832179ffa5e29717cfbdd92b9a1668bd165988120b9453fe0c670ffa6ea53e50a71ac77b601d3ae73ac5046af1129226a430842fb5871504894594f82417241463e59c4737a870e3806ee65f33b7813d2655457e32e2558bf8a9fae93c2d87be50eb3bb8be63f9ef58f13924e8b4bbea83e23a4654f2ef5183de9661110d80336b138d80b350a2ff428ad5a8dfc42c4f5622fc0b162ec58d19e1a74362fb28f33ec79ecbf1306485fd7abd75b59399fa8838cd44b85a001352f16b003cd51b748c317fb7415f2ab121073e62d0b94dab6486fa80412ac222664e7112ec5333116531ae4211ec9bea4e8906a04654ca3295483e392480afee384ba5b5ad9c64a31cfe1bd9f8ec0c5ed46a9abe8c31e1e671cc1788bb645717cae22d80afb131f9a033c873c7166ef5ad7276c772d007383258f000c9cef39761cfd9bdfaa9c9945221f1ec9ec80f851dff1aad0c2bad5fcd5a357a92c5fdf1ae6cc68eb27b205ae548fb895aea8333c74cbb2c98e89351613f3c01b6a8882f0e91b6e20030c084da44d688e276f394ef3bff6164b48187df781c199237d436241c6b462a90c357acbbe170b9dcb1a277cb7115eaa85b0f5dd183be28d41c0b4deecd24a94a56328f83b388b13b87d0f3788ba95052994651dc15ff7a853388d3ae5b3409024a1d46122067a4afd086ab499186ae93008f43690afc7be1faaa12a3f60f58f89edba6396f058ac5de05394f36219d29dae85ae57eb8a8275320dfd2cae7c45ef52b485d78f9f34fb29fde8c234536b91ac86922743915fdff4b6c7d9f87ce14896519051a252319e2d65a73f8bdabb1b14c694c1965ec3b4ea26d36eaa7a0c0fa0a8b7809a31cd2f211ba2bc3aa7fef2c9577f3ed493267f9e68020ef17b0ab82d42cc6695af7d2e06ed798af93551ecaba06fb86aedc2e7cd2dfefa6d301ecd8e114024db0d00ee0244e7d71009cda6edda072c0c84ce99501a3bdfdd0af1d069ce38bef69f91565869e9f96236fe6f3a0c052d942f3a92b0d6dc3684276b5cb93ff56b65ebceabed3aeefb7fc76af1daa894845a088fcc8c466f3342bf6ca2c759fe13a43d0e5e0f4ad6f8ff91121073124faaf72bb903fa95d393b14f9c3ffba2e1d991a9d5884d61783fde89e903a1ec28e343184f48ca4e01e4e6a3a60b7a7e63394a6effd426ee4ce6d9f4cffbdee0dc7c8cac7fe4d3a151";
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedSig1), sig1));
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedSig2), sig2));
		assertEquals(true, XMSSUtil.compareByteArray(Hex.decode(expectedSig3), sig3));
	}
	
	public void testVerifySignatureSHA256() {
		XMSSParameters params = new XMSSParameters(10, new SHA256Digest(), 16);
		XMSS xmss = new XMSS(params, new NullPRNG());
		xmss.generateKeys();
		byte[] publicKey = xmss.getPublicKey();
		byte[] msg1 = new byte[1024];
		byte[] signature = xmss.sign(msg1);
		try {
			assertEquals(true, xmss.verifySignature(msg1, signature, publicKey));
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
		byte[] msg2 = new byte[1024];
		msg2[0] = 0x01;
		try {
			assertEquals(false, xmss.verifySignature(msg2, signature, publicKey));
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
	}
	
	public void testVerifySignatureSHA512() {
		XMSSParameters params = new XMSSParameters(10, new SHA512Digest(), 16);
		XMSS xmss = new XMSS(params, new NullPRNG());
		xmss.generateKeys();
		byte[] publicKey = xmss.getPublicKey();
		byte[] msg1 = new byte[1024];
		byte[] signature = xmss.sign(msg1);
		try {
			assertEquals(true, xmss.verifySignature(msg1, signature, publicKey));
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
		byte[] msg2 = new byte[1024];
		msg2[0] = 0x01;
		try {
			assertEquals(false, xmss.verifySignature(msg2, signature, publicKey));
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
	}
	
	public void testImportKeysSHA256() {
		XMSSParameters params = new XMSSParameters(10, new SHA256Digest(), 16);
		XMSS xmss1 = new XMSS(params, new NullPRNG());
		xmss1.generateKeys();
		byte[] msg1 = new byte[1024];
		byte[] msg2 = new byte[2048];
		byte[] msg3 = new byte[3096];
		Arrays.fill(msg1, (byte) 0xaa);
		Arrays.fill(msg2, (byte) 0xbb);
		Arrays.fill(msg3, (byte) 0xcc);
		byte[] signature1 = xmss1.sign(msg1);
		byte[] signature2 = xmss1.sign(msg2);
		byte[] exportedPrivateKey = xmss1.getPrivateKey();
		byte[] exportedPublicKey = xmss1.getPublicKey();
		byte[] publicKey = xmss1.getPublicKey();
		byte[] signature3 = xmss1.sign(msg3);
		
		XMSS xmss2 = new XMSS(params, new NullPRNG());
		try {
			xmss2.importKeys(exportedPrivateKey, exportedPublicKey);
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
		byte[] signature4 = xmss2.sign(msg3);
		assertEquals(true, XMSSUtil.compareByteArray(signature3, signature4));
		xmss2.generateKeys();
		try {
			assertEquals(true, xmss2.verifySignature(msg1, signature1, publicKey));
			assertEquals(true, xmss2.verifySignature(msg2, signature2, publicKey));
			assertEquals(true, xmss2.verifySignature(msg3, signature3, publicKey));
			assertEquals(false, xmss2.verifySignature(msg1, signature3, publicKey));
			assertEquals(false, xmss2.verifySignature(msg2, signature3, publicKey));
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
	}
	
	public void testImportKeysSHA512() {
		XMSSParameters params = new XMSSParameters(10, new SHA512Digest(), 16);
		XMSS xmss1 = new XMSS(params, new NullPRNG());
		xmss1.generateKeys();
		byte[] msg1 = new byte[1024];
		byte[] msg2 = new byte[2048];
		byte[] msg3 = new byte[3096];
		Arrays.fill(msg1, (byte) 0xaa);
		Arrays.fill(msg2, (byte) 0xbb);
		Arrays.fill(msg3, (byte) 0xcc);
		byte[] signature1 = xmss1.sign(msg1);
		byte[] signature2 = xmss1.sign(msg2);
		byte[] exportedPrivateKey = xmss1.getPrivateKey();
		byte[] exportedPublicKey = xmss1.getPublicKey();
		byte[] publicKey = xmss1.getPublicKey();
		byte[] signature3 = xmss1.sign(msg3);
		
		XMSS xmss2 = new XMSS(params, new NullPRNG());
		try {
			xmss2.importKeys(exportedPrivateKey, exportedPublicKey);
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
		byte[] signature4 = xmss2.sign(msg3);
		assertEquals(true, XMSSUtil.compareByteArray(signature3, signature4));
		xmss2.generateKeys();
		try {
			assertEquals(true, xmss2.verifySignature(msg1, signature1, publicKey));
			assertEquals(true, xmss2.verifySignature(msg2, signature2, publicKey));
			assertEquals(true, xmss2.verifySignature(msg3, signature3, publicKey));
			assertEquals(false, xmss2.verifySignature(msg1, signature3, publicKey));
			assertEquals(false, xmss2.verifySignature(msg2, signature3, publicKey));
		} catch (ParseException ex) {
			ex.printStackTrace();
			fail();
		}
	}
}
